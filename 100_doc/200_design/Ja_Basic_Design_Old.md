# åŸºæœ¬è¨­è¨ˆæ›¸
# Tributary - Solanaå ±é…¬é…å¸ƒã‚·ã‚¹ãƒ†ãƒ 

**æ›´æ–°æ—¥**: 2025-09-18
**æ›´æ–°è€…**: akameGusya

## æ¦‚è¦
Tributaryã‚·ã‚¹ãƒ†ãƒ ã®TypeScript/Node.jså®Ÿè£…ã«ãŠã‘ã‚‹åŸºæœ¬è¨­è¨ˆæ€æƒ³ã¨è¨­è¨ˆåˆ¤æ–­ã®æ ¹æ‹ ã‚’å®šç¾©ã—ã¾ã™ã€‚ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è¨­è¨ˆæ„å›³ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã®é–¢ä¿‚æ€§ã€ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®è¨­è¨ˆåŸå‰‡ã‚’è¨˜è¿°ã—ã€å®Ÿè£…æ™‚ã®æŒ‡é‡ã¨ãªã‚‹è¨­è¨ˆå“²å­¦ã‚’æä¾›ã—ã¾ã™ã€‚

## è¨­è¨ˆæ–‡æ›¸ã®æ–¹é‡
æœ¬æ–‡æ›¸ã¯å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰å®Ÿè£…ã§ã¯ãªãã€è¨­è¨ˆã®æ„å›³ã€æ ¹æ‹ ã€è€ƒæ…®äº‹é …ã«ç„¦ç‚¹ã‚’å½“ã¦ã¦ã„ã¾ã™ã€‚å®Ÿè£…è©³ç´°ã¯åˆ¥é€”ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã§ç®¡ç†ã—ã€æœ¬æ–‡æ›¸ã§ã¯ã€Œãªãœãã®è¨­è¨ˆã«ã—ãŸã®ã‹ã€ã€Œã©ã®ã‚ˆã†ãªè€ƒæ…®äº‹é …ãŒã‚ã‚‹ã®ã‹ã€ã‚’ä¸­å¿ƒã«è¨˜è¿°ã—ã¾ã™ã€‚

## 1. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### 1.1 ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        User Interface                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   CLI Commands  â”‚  â”‚   Web Dashboard â”‚  â”‚   REST API      â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚   (Future)      â”‚  â”‚   (Future)      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Application Layer                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Wallet Collectorâ”‚  â”‚ Distribution    â”‚  â”‚ Report          â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚ Engine          â”‚  â”‚ Generator       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Service Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Token Service   â”‚  â”‚ Config Manager  â”‚  â”‚ Logger Service  â”‚ â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Infrastructure Layer                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Solana RPC      â”‚  â”‚ File System     â”‚  â”‚ External APIs   â”‚ â”‚
â”‚  â”‚ - @solana/web3  â”‚  â”‚ - Config Files  â”‚  â”‚ - CoinGecko     â”‚ â”‚
â”‚  â”‚ - @solana/spl   â”‚  â”‚ - Log Files     â”‚  â”‚ - Jupiter       â”‚ â”‚
â”‚  â”‚ - Metaplex      â”‚  â”‚ - Cache Files   â”‚  â”‚ - Webhooks      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆ

#### **Presentation Layer (è¡¨ç¤ºå±¤)**
- **CLI Commands**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ã‚³ãƒãƒ³ãƒ‰å…¥åŠ›ã‚’å—ã‘ä»˜ã‘
- **Web Dashboard**: å°†æ¥çš„ãªWeb UIï¼ˆPhase 3ã§å®Ÿè£…äºˆå®šï¼‰
- **REST API**: å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æºç”¨APIï¼ˆPhase 3ã§å®Ÿè£…äºˆå®šï¼‰

#### **Application Layer (ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤)**
- **Wallet Collector**: ãƒˆãƒ¼ã‚¯ãƒ³ä¿æœ‰è€…ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹åé›†
- **Distribution Engine**: é…å¸ƒãƒ­ã‚¸ãƒƒã‚¯ã®å®Ÿè¡Œã¨ç®¡ç†
- **Report Generator**: å®Ÿè¡Œçµæœã®ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

#### **Service Layer (ã‚µãƒ¼ãƒ“ã‚¹å±¤)**
- **Token Service**: Solanaãƒˆãƒ¼ã‚¯ãƒ³æ“ä½œã®æŠ½è±¡åŒ–
- **Config Manager**: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç®¡ç†ã¨æ¤œè¨¼
- **Logger Service**: ãƒ­ã‚°å‡ºåŠ›ã¨ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†

#### **Infrastructure Layer (ã‚¤ãƒ³ãƒ•ãƒ©å±¤)**
- **Solana RPC**: ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã¨ã®é€šä¿¡
- **File System**: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹
- **External APIs**: å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹é€£æº

### 1.3 ä¾å­˜é–¢ä¿‚

#### **ä¾å­˜é–¢ä¿‚ã®åŸå‰‡**
1. **ä¸Šä½å±¤ â†’ ä¸‹ä½å±¤**: ä¸Šä½å±¤ã¯ä¸‹ä½å±¤ã«ä¾å­˜å¯èƒ½
2. **åŒå±¤å†…**: åŒå±¤å†…ã§ã®ä¾å­˜ã¯æœ€å°é™ã«æŠ‘åˆ¶
3. **é€†å‘ãä¾å­˜ç¦æ­¢**: ä¸‹ä½å±¤ã¯ä¸Šä½å±¤ã«ä¾å­˜ã—ãªã„
4. **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹åˆ†é›¢**: å…·è±¡ã‚¯ãƒ©ã‚¹ã§ã¯ãªãã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜

#### **ä¾å­˜é–¢ä¿‚ã®è¨­è¨ˆæˆ¦ç•¥**

**Application Layer ã®ä¾å­˜é–¢ä¿‚**:
- **WalletCollector**: ãƒˆãƒ¼ã‚¯ãƒ³æ“ä½œã‚µãƒ¼ãƒ“ã‚¹ã«ä¾å­˜ã—ã€ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŠ½è±¡åŒ–
- **DistributionEngine**: ãƒˆãƒ¼ã‚¯ãƒ³æ“ä½œã¨è¨­å®šç®¡ç†ã®ä¸¡æ–¹ã«ä¾å­˜ã—ã€é…å¸ƒå‡¦ç†ã®è¤‡åˆçš„ãªæ©Ÿèƒ½ã‚’å®Ÿç¾
- **ReportGenerator**: ãƒ­ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã«ä¾å­˜ã—ã€å®Ÿè¡Œçµæœã®è¨˜éŒ²ã¨å‡ºåŠ›ã‚’ä¸€å…ƒç®¡ç†

**Service Layer ã®ä¾å­˜é–¢ä¿‚**:
- **TokenService**: Solana RPC ã¸ã®ä¾å­˜ã‚’é›†ç´„ã—ã€ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³å›ºæœ‰ã®å‡¦ç†ã‚’éš è”½
- **ConfigManager**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ä¾å­˜ã‚’ç®¡ç†ã—ã€è¨­å®šã®æ°¸ç¶šåŒ–ã¨æ¤œè¨¼ã‚’æ‹…å½“
- **LoggerService**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ä¾å­˜ã‚’åˆ¶å¾¡ã—ã€ç›£æŸ»è¦ä»¶ã«å¯¾å¿œã™ã‚‹ãƒ­ã‚°ç®¡ç†ã‚’å®Ÿç¾

**è¨­è¨ˆæ ¹æ‹ **: å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå¿…è¦æœ€å°é™ã®ä¾å­˜é–¢ä¿‚ã®ã¿ã‚’æŒã¤ã“ã¨ã§ã€å˜ä½“ãƒ†ã‚¹ãƒˆã®å®¹æ˜“æ€§ã¨ä¿å®ˆæ€§ã‚’ç¢ºä¿ã€‚ç‰¹ã«å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ä¾å­˜ã¯ä¸‹ä½å±¤ã«é›†ç´„ã—ã€å¤‰æ›´ã®å½±éŸ¿ç¯„å›²ã‚’é™å®šã€‚

#### **ä¾å­˜æ€§æ³¨å…¥ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¡ç”¨ç†ç”±**

**ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ–¹å¼**:
- å¿…è¦ãªä¾å­˜é–¢ä¿‚ã‚’ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§æ˜ç¤ºçš„ã«å—ã‘å–ã‚‹è¨­è¨ˆ
- å®Ÿè¡Œæ™‚ã§ã¯ãªãã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆæ™‚ã«ä¾å­˜é–¢ä¿‚ã‚’ç¢ºå®š
- ãƒ†ã‚¹ãƒˆæ™‚ã®ãƒ¢ãƒƒã‚¯æ³¨å…¥ãŒå®¹æ˜“ã§ã€å˜ä½“ãƒ†ã‚¹ãƒˆã®ç‹¬ç«‹æ€§ã‚’ç¢ºä¿

**ã‚µãƒ¼ãƒ“ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã®è¨­è¨ˆ**:
- å…¨ã‚µãƒ¼ãƒ“ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç”Ÿæˆã¨ç®¡ç†ã‚’ä¸€å…ƒåŒ–
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã«ä¾å­˜é–¢ä¿‚ã‚’è§£æ±º
- å¾ªç’°ä¾å­˜ã®æ¤œå‡ºã¨é˜²æ­¢æ©Ÿèƒ½ã‚’æä¾›

**è¨­è¨ˆåŠ¹æœ**: ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šã€æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ã®è¿½åŠ ã‚„æ—¢å­˜ã‚µãƒ¼ãƒ“ã‚¹ã®å…¥ã‚Œæ›¿ãˆãŒæ—¢å­˜ã‚³ãƒ¼ãƒ‰ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã“ã¨ãªãå®Ÿç¾å¯èƒ½ã€‚ã¾ãŸã€å„å±¤ã®è²¬å‹™ãŒæ˜ç¢ºã«åˆ†é›¢ã•ã‚Œã€é–‹ç™ºãƒãƒ¼ãƒ å†…ã§ã®ä½œæ¥­åˆ†æ‹…ãŒåŠ¹ç‡åŒ–ã•ã‚Œã‚‹ã€‚

### 1.4 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### **CLIå®Ÿè¡Œç’°å¢ƒ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Local Environment                      â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                  Tributary CLI                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚  â”‚  â”‚   Node.js       â”‚  â”‚   Binary        â”‚               â”‚ â”‚
â”‚  â”‚  â”‚   Runtime       â”‚  â”‚   (pkg)         â”‚               â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  Local Files:                                               â”‚
â”‚  - ~/.tributary/config.toml                                 â”‚
â”‚  - ~/.tributary/logs/                                       â”‚
â”‚  - ~/.tributary/cache/                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                           Network
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    External Services                        â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Solana RPC    â”‚  â”‚ CoinGecko API â”‚  â”‚ Jupiter API     â”‚   â”‚
â”‚  â”‚ - Mainnet     â”‚  â”‚ - Price Data  â”‚  â”‚ - Price Oracle  â”‚   â”‚
â”‚  â”‚ - Testnet     â”‚  â”‚               â”‚  â”‚                 â”‚   â”‚
â”‚  â”‚ - Devnet      â”‚  â”‚               â”‚  â”‚                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **ã‚µãƒ¼ãƒãƒ¼é…ç½®ãƒ‘ã‚¿ãƒ¼ãƒ³**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Server Environment                    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   Docker Container                      â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚  â”‚  â”‚ Tributary API   â”‚  â”‚ Scheduled Tasks â”‚               â”‚ â”‚
â”‚  â”‚  â”‚ - REST API      â”‚  â”‚ - Cron Jobs     â”‚               â”‚ â”‚
â”‚  â”‚  â”‚ - Health Check  â”‚  â”‚ - Auto Dist.    â”‚               â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  Persistent Volumes:                                        â”‚
â”‚  - /app/config/                                             â”‚
â”‚  - /app/logs/                                               â”‚
â”‚  - /app/data/                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **é…å¸ƒæˆ¦ç•¥ã¨è¨­è¨ˆè€ƒæ…®äº‹é …**

**1. npm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸é…å¸ƒ**
- **å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼**: Node.jsé–‹ç™ºç’°å¢ƒã‚’æŒã¤é–‹ç™ºè€…
- **è¨­è¨ˆæ„å›³**: æ—¢å­˜ã®Node.jsã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã¨ã®è¦ªå’Œæ€§ã‚’æ´»ç”¨
- **åˆ©ç‚¹**: ä¾å­˜é–¢ä¿‚ã®è‡ªå‹•è§£æ±ºã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã®ç°¡ç´ åŒ–

**2. ãƒã‚¤ãƒŠãƒªé…å¸ƒ**
- **å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼**: Node.jsç’°å¢ƒã‚’æŒãŸãªã„ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼
- **è¨­è¨ˆæ„å›³**: ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å›ºæœ‰ã®æœ€é©åŒ–ã¨å®Ÿè¡Œç’°å¢ƒã®ç‹¬ç«‹æ€§
- **åˆ©ç‚¹**: ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ä¾å­˜ãªã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ã®ç°¡ç´ åŒ–

**3. Dockerå®Ÿè¡Œ**
- **å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼**: DevOpsç’°å¢ƒãŠã‚ˆã³CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- **è¨­è¨ˆæ„å›³**: ç’°å¢ƒã®æ¨™æº–åŒ–ã¨å†ç¾æ€§ã®ç¢ºä¿
- **åˆ©ç‚¹**: ç’°å¢ƒå·®ç•°ã®æ’é™¤ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªå®Ÿè¡ŒåŸºç›¤

**4. ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œ**
- **å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼**: é–‹ç™ºè€…ãŠã‚ˆã³ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¿…è¦ãªãƒ¦ãƒ¼ã‚¶ãƒ¼
- **è¨­è¨ˆæ„å›³**: é€æ˜æ€§ã®ç¢ºä¿ã¨æ©Ÿèƒ½æ‹¡å¼µã®å®¹æ˜“æ€§
- **åˆ©ç‚¹**: å®Œå…¨ãªã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ã®å®Ÿæ–½å¯èƒ½æ€§

## 2. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ

### 2.1 Wallet Collector

#### 2.1.1 è¨­è¨ˆç›®çš„ã¨è²¬å‹™
**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç›®çš„**:
ç‰¹å®šã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿æœ‰ã™ã‚‹ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’åŠ¹ç‡çš„ã«åé›†ã—ã€é…å¸ƒå¯¾è±¡è€…ã®ãƒªã‚¹ãƒˆã‚’ä½œæˆã™ã‚‹ã€‚å¤§é‡ã®ã‚ªãƒ³ãƒã‚§ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¿…è¦ãªæƒ…å ±ã®ã¿ã‚’æŠ½å‡ºã—ã€å¾Œç¶šã®é…å¸ƒå‡¦ç†ã§åˆ©ç”¨å¯èƒ½ãªå½¢å¼ã§æä¾›ã™ã‚‹ã€‚

**ä¸»è¦ãªè²¬å‹™**:
- **ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç™ºè¦‹**: Solanaãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ä¸Šã§æŒ‡å®šãƒˆãƒ¼ã‚¯ãƒ³ã®ä¿æœ‰è€…ã‚’åŒ…æ‹¬çš„ã«æ¤œç´¢
- **ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: ä¿æœ‰é‡ã®é–¾å€¤ã‚„é™¤å¤–æ¡ä»¶ã«åŸºã¥ãå¯¾è±¡è€…ã®çµã‚Šè¾¼ã¿
- **æƒ…å ±æ­£è¦åŒ–**: åé›†ã—ãŸç”Ÿãƒ‡ãƒ¼ã‚¿ã‚’çµ±ä¸€çš„ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§æ§‹é€ åŒ–
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã«ã‚ˆã‚‹é‡è¤‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å‰Šæ¸›

#### 2.1.2 ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆæ€æƒ³
**APIè¨­è¨ˆã®åŸºæœ¬æ–¹é‡**:
- **å˜ä¸€è²¬ä»»**: å„ãƒ¡ã‚½ãƒƒãƒ‰ã¯ç‰¹å®šã®æ©Ÿèƒ½ã®ã¿ã‚’æ‹…å½“ã—ã€è¤‡åˆçš„ãªå‡¦ç†ã¯ä¸Šä½å±¤ã§çµ„ã¿åˆã‚ã›
- **éåŒæœŸå‡¦ç†**: ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã‚¢ã‚¯ã‚»ã‚¹ã®ç‰¹æ€§ã‚’è€ƒæ…®ã—ãŸ Promise ãƒ™ãƒ¼ã‚¹ã®è¨­è¨ˆ
- **æ‹¡å¼µæ€§**: å°†æ¥çš„ãªæ©Ÿèƒ½è¿½åŠ ï¼ˆè¤‡æ•°ãƒˆãƒ¼ã‚¯ãƒ³åŒæ™‚åé›†ç­‰ï¼‰ã«å¯¾å¿œå¯èƒ½ãªæŸ”è»Ÿãªå¼•æ•°è¨­è¨ˆ

**æ ¸å¿ƒã¨ãªã‚‹æ“ä½œ**:
- **collectHolders**: ãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½ã¨ã—ã¦ã€åŒ…æ‹¬çš„ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å—ã‘å–ã‚Šå®Œå…¨ãªãƒ›ãƒ«ãƒ€ãƒ¼æƒ…å ±ã‚’è¿”å´
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†**: é«˜é »åº¦ã§ã®åŒä¸€ãƒˆãƒ¼ã‚¯ãƒ³æ¤œç´¢ã«å¯¾å¿œã™ã‚‹ãŸã‚ã€ç‹¬ç«‹ã—ãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥æ“ä½œã‚’æä¾›
- **ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¤œè¨¼**: åé›†ã—ãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã®æœ‰åŠ¹æ€§ç¢ºèªã«ã‚ˆã‚Šã€é…å¸ƒã‚¨ãƒ©ãƒ¼ã‚’äº‹å‰ã«é˜²æ­¢

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®è¨­è¨ˆæ„å›³**:
- **CollectHoldersParams**: æ¤œç´¢æ¡ä»¶ã®çµ„ã¿åˆã‚ã›ã‚’æŸ”è»Ÿã«æŒ‡å®šå¯èƒ½ã¨ã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«ã‚ˆã‚Šç°¡å˜ãªä½¿ç”¨ã‚‚å¯èƒ½
- **WalletHolder**: é…å¸ƒè¨ˆç®—ã«å¿…è¦ãªå…¨æƒ…å ±ã‚’å«ã¿ã€ã‹ã¤ç›£æŸ»è¦ä»¶ã‚’æº€ãŸã™è¿½è·¡å¯èƒ½æ€§ã‚’ç¢ºä¿

#### 2.1.3 å®Ÿè£…ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨ãƒ­ã‚¸ãƒƒã‚¯

**ãƒ¡ã‚¤ãƒ³å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
1. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥å„ªå…ˆæˆ¦ç•¥**: åˆå›ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®å­˜åœ¨ç¢ºèªã‚’è¡Œã„ã€æœ‰åŠ¹ãªãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Œã°å³åº§ã«è¿”å´ã€‚ã“ã‚Œã«ã‚ˆã‚Šãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã¸ã®é‡è¤‡ã‚¢ã‚¯ã‚»ã‚¹ã‚’å‰Šæ¸›ã—ã€å¿œç­”æ™‚é–“ã‚’å¤§å¹…ã«çŸ­ç¸®ã€‚

2. **æ®µéšçš„ãƒ‡ãƒ¼ã‚¿å–å¾—**: ã‚ªãƒ³ãƒã‚§ãƒ¼ãƒ³ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã¯è¤‡æ•°æ®µéšã«åˆ†å‰²ã—ã¦å®Ÿè¡Œ
   - ãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸€è¦§ã®å–å¾—
   - å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æ®‹é«˜æƒ…å ±å–å¾—
   - ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ‰€æœ‰è€…æƒ…å ±ã®å–å¾—

3. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¨ˆç®—**: å…¨ãƒ‡ãƒ¼ã‚¿å–å¾—å¾Œã«ä¿æœ‰å‰²åˆã‚’è¨ˆç®—ã—ã€é…å¸ƒæ¯”ç‡æ±ºå®šã®ãŸã‚ã®æ­£è¦åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ

4. **ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æˆ¦ç•¥**: å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦æ¡ä»¶ãƒ™ãƒ¼ã‚¹ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’é©ç”¨ã—ã€é…å¸ƒå¯¾è±¡ã¨ã—ã¦é©åˆ‡ã§ãªã„ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’é™¤å¤–

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®è¨­è¨ˆæ€æƒ³**:
- **ãƒãƒƒãƒå‡¦ç†**: å¤§é‡ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±å–å¾—ã‚’ãƒãƒƒãƒå˜ä½ã§å®Ÿè¡Œã—ã€RPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã®è² è·ã‚’åˆ†æ•£
- **ä¸¦è¡Œå‡¦ç†**: ç‹¬ç«‹ã—ãŸæ®‹é«˜ç¢ºèªå‡¦ç†ã‚’ä¸¦è¡Œå®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ç·å®Ÿè¡Œæ™‚é–“ã‚’çŸ­ç¸®
- **æ®µéšçš„ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: æ—©æœŸã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶ã‚’é©ç”¨ã—ã€ä¸è¦ãªãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚’å‰Šæ¸›

**ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ–¹é‡**:
- **éƒ¨åˆ†å¤±æ•—å¯¾å¿œ**: ä¸€éƒ¨ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæƒ…å ±å–å¾—ã«å¤±æ•—ã—ã¦ã‚‚ã€å‡¦ç†ã‚’ç¶™ç¶šã—ã€å–å¾—å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã§é…å¸ƒã‚’å®Ÿè¡Œ
- **ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã‚„ä¸€æ™‚çš„ãªRPCéšœå®³ã«å¯¾ã™ã‚‹è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤
- **è©³ç´°ãƒ­ã‚°**: å„å‡¦ç†æ®µéšã§ã®è©³ç´°ãªãƒ­ã‚°å‡ºåŠ›ã«ã‚ˆã‚Šã€å•é¡Œã®ç‰¹å®šã¨åˆ†æã‚’æ”¯æ´

### 2.2 Distribution Engine

#### 2.2.1 è¨­è¨ˆç›®çš„ã¨è²¬å‹™
**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç›®çš„**:
åé›†ã•ã‚ŒãŸã‚¦ã‚©ãƒ¬ãƒƒãƒˆæƒ…å ±ã‚’åŸºã«ã€å…¬å¹³ã§æ­£ç¢ºãªãƒˆãƒ¼ã‚¯ãƒ³é…å¸ƒã‚’å®Ÿè¡Œã™ã‚‹ã€‚è¤‡é›‘ãªé…å¸ƒãƒ­ã‚¸ãƒƒã‚¯ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ã€ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚’çµ±åˆã—ã€å¤§è¦æ¨¡é…å¸ƒã«ãŠã„ã¦ã‚‚ç¢ºå®Ÿæ€§ã¨ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚’ç¢ºä¿ã™ã‚‹ã€‚

**ä¸»è¦ãªè²¬å‹™**:
- **é…å¸ƒè¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³**: ä¿æœ‰é‡æ¯”ç‡ã«åŸºã¥ãæ­£ç¢ºãªé…å¸ƒé‡è¨ˆç®—ã¨æ¤œè¨¼
- **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†**: ãƒãƒƒãƒå‡¦ç†ã«ã‚ˆã‚‹ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
- **çŠ¶æ…‹ç®¡ç†**: é…å¸ƒãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã®é€²æ—ã¨çµæœã®è¿½è·¡
- **éšœå®³å›å¾©**: éƒ¨åˆ†å¤±æ•—æ™‚ã®çŠ¶æ…‹å¾©æ—§ã¨ç¶™ç¶šå®Ÿè¡Œãƒ¡ã‚«ãƒ‹ã‚ºãƒ 

#### 2.2.2 ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆæ€æƒ³
**APIè¨­è¨ˆã®æ ¸å¿ƒæˆ¦ç•¥**:
- **æ“ä½œã®é€æ˜æ€§**: å…¨ã¦ã®é…å¸ƒæ“ä½œã§è©³ç´°ãªå®Ÿè¡Œçµæœã¨çµ±è¨ˆæƒ…å ±ã‚’æä¾›
- **æ®µéšçš„å®Ÿè¡Œ**: ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã«ã‚ˆã‚Šäº‹å‰æ¤œè¨¼ã‚’å¯èƒ½ã¨ã—ã€å®Ÿè¡Œå‰ã®ãƒªã‚¹ã‚¯è©•ä¾¡ã‚’æ”¯æ´
- **ç›£æŸ»å¯¾å¿œ**: å…¨ã¦ã®é…å¸ƒå±¥æ­´ã‚’è¨˜éŒ²ã—ã€å¾Œç¶šã®ç›£æŸ»è¦ä»¶ã«å¯¾å¿œ

**æ ¸å¿ƒã¨ãªã‚‹æ“ä½œè¨­è¨ˆ**:
- **executeDistribution**: å®Ÿéš›ã®é…å¸ƒå®Ÿè¡Œã§ã€åŒ…æ‹¬çš„ãªçµæœãƒ¬ãƒãƒ¼ãƒˆã‚’æä¾›
- **simulateDistribution**: ãƒªã‚¹ã‚¯ãƒ•ãƒªãƒ¼ãªã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œã«ã‚ˆã‚Šã€å®Ÿè¡Œå‰ã®æ¤œè¨¼ã‚’å®Ÿç¾
- **getDistributionStatus**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãªé€²æ—ç›£è¦–æ©Ÿèƒ½ã§ã€é•·æ™‚é–“å®Ÿè¡Œã«ãŠã‘ã‚‹å¯è¦–æ€§ã‚’ç¢ºä¿
- **getDistributionHistory**: éå»ã®å®Ÿè¡Œå±¥æ­´ç®¡ç†ã«ã‚ˆã‚Šã€ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æã¨æ”¹å–„ç‚¹ç‰¹å®šã‚’æ”¯æ´

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®è¨­è¨ˆæ ¹æ‹ **:
- **DistributionParams**: æŸ”è»Ÿãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šã«ã‚ˆã‚Šã€æ§˜ã€…ãªé…å¸ƒã‚·ãƒŠãƒªã‚ªã«å¯¾å¿œ
- **DistributionResult**: å®Ÿè¡Œçµæœã®åŒ…æ‹¬çš„ãªè¨˜éŒ²ã«ã‚ˆã‚Šã€ç›£æŸ»è¦ä»¶ã¨åˆ†æãƒ‹ãƒ¼ã‚ºã®ä¸¡æ–¹ã‚’æº€ãŸã™
- **TransactionResult**: å€‹åˆ¥ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ãƒ™ãƒ«ã§ã®è©³ç´°æƒ…å ±ã«ã‚ˆã‚Šã€å•é¡Œç‰¹å®šã¨å¯¾å¿œã‚’åŠ¹ç‡åŒ–

#### 2.2.3 å®Ÿè£…ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨ãƒ­ã‚¸ãƒƒã‚¯

**ãƒ¡ã‚¤ãƒ³é…å¸ƒå‡¦ç†ãƒ•ãƒ­ãƒ¼**:
1. **äº‹å‰è¨ˆç®—ãƒ•ã‚§ãƒ¼ã‚º**: å—ä¿¡è€…ã®ä¿æœ‰é‡ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å…¬æ­£ãªé…å¸ƒé‡ã‚’ç²¾å¯†è¨ˆç®—ã€‚ä¸¸ã‚èª¤å·®ã‚’æœ€å°åŒ–ã—ã€ç·é¡ã®æ•´åˆæ€§ã‚’ä¿è¨¼ã€‚

2. **æ¤œè¨¼ãƒ•ã‚§ãƒ¼ã‚º**: ãƒ‰ãƒ©ã‚¤ãƒ©ãƒ³æ©Ÿèƒ½ã«ã‚ˆã‚Šã€å®Ÿéš›ã®è³‡é‡‘ç§»å‹•å‰ã«å…¨è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ¤œè¨¼ã€‚ã‚¬ã‚¹è²»ç”¨è¦‹ç©ã‚‚ã‚Šã¨æ½œåœ¨çš„ãªå¤±æ•—ã‚±ãƒ¼ã‚¹ã®ç‰¹å®šã‚’å®Ÿè¡Œã€‚

3. **å®Ÿè¡Œãƒ•ã‚§ãƒ¼ã‚º**: è¨ˆç®—æ¸ˆã¿é…å¸ƒæƒ…å ±ã‚’åŸºã«ãƒãƒƒãƒå˜ä½ã§ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã€‚ä¸¦è¡Œå‡¦ç†ã«ã‚ˆã‚Šå…¨ä½“ã®å®Ÿè¡Œæ™‚é–“ã‚’æœ€é©åŒ–ã€‚

4. **çµæœè¨˜éŒ²ãƒ•ã‚§ãƒ¼ã‚º**: å®Ÿè¡Œçµæœã®è©³ç´°ãªè¨˜éŒ²ã¨æ°¸ç¶šåŒ–ã«ã‚ˆã‚Šã€ç›£æŸ»è¨¼è·¡ã¨å°†æ¥ã®åˆ†æåŸºç›¤ã‚’æä¾›ã€‚

**é…å¸ƒé‡è¨ˆç®—ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **:
- **æ¯”ä¾‹é…åˆ†åŸç†**: å„å—ä¿¡è€…ã®åŸºæº–ãƒˆãƒ¼ã‚¯ãƒ³ä¿æœ‰é‡ã«æ­£æ¯”ä¾‹ã—ãŸé…å¸ƒé‡ã‚’ç®—å‡º
- **ç²¾åº¦ä¿è¨¼**: æµ®å‹•å°æ•°ç‚¹æ¼”ç®—ã®ç²¾åº¦å•é¡Œã‚’å›é¿ã™ã‚‹ãŸã‚ã€æ•´æ•°æ¼”ç®—ã‚’åŸºæœ¬ã¨ã—ãŸè¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
- **ç·é¡ä¿è¨¼**: å€‹åˆ¥é…å¸ƒé‡ã®åˆè¨ˆãŒæŒ‡å®šç·é¡ã‚’è¶…éã—ãªã„ã“ã¨ã‚’æ•°å­¦çš„ã«ä¿è¨¼
- **å…¬å¹³æ€§ç¢ºä¿**: æœ€å°é…å¸ƒå˜ä½ã®è¨­å®šã«ã‚ˆã‚Šã€ãƒã‚¤ã‚¯ãƒ­é…å¸ƒã«ã‚ˆã‚‹ä¸å…¬å¹³ã‚’é˜²æ­¢

**ãƒãƒƒãƒå‡¦ç†æˆ¦ç•¥**:
- **å‹•çš„ãƒãƒƒãƒã‚µã‚¤ã‚º**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ³ã¨ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¤‡é›‘åº¦ã«å¿œã˜ãŸãƒãƒƒãƒã‚µã‚¤ã‚ºã®è‡ªå‹•èª¿æ•´
- **ä¸¦è¡Œå®Ÿè¡Œ**: ãƒãƒƒãƒå†…ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸¦è¡Œå‡¦ç†ã«ã‚ˆã‚‹å®Ÿè¡Œæ™‚é–“ã®æœ€å°åŒ–
- **éšœå®³åˆ†é›¢**: å€‹åˆ¥ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¤±æ•—ãŒä»–ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«å½±éŸ¿ã—ãªã„åˆ†é›¢å®Ÿè¡Œ
- **é€²æ—ç›£è¦–**: ãƒãƒƒãƒå˜ä½ã§ã®é€²æ—å ±å‘Šã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ³æŠŠæ¡

**ã‚¨ãƒ©ãƒ¼å‡¦ç†ã¨å¾©æ—§ãƒ¡ã‚«ãƒ‹ã‚ºãƒ **:
- **æ®µéšçš„ãƒªãƒˆãƒ©ã‚¤**: ä¸€æ™‚çš„ãªå¤±æ•—ã«å¯¾ã™ã‚‹æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ã‚’ç”¨ã„ãŸè‡ªå‹•ãƒªãƒˆãƒ©ã‚¤
- **éƒ¨åˆ†å®Ÿè¡Œç¶™ç¶š**: ä¸€éƒ¨å¤±æ•—æ™‚ã§ã‚‚æˆåŠŸã—ãŸé…å¸ƒã‚’ä¿æŒã—ã€å¤±æ•—åˆ†ã®ã¿å†å®Ÿè¡Œ
- **çŠ¶æ…‹å¾©æ—§**: ä¸­æ–­ã•ã‚ŒãŸé…å¸ƒå‡¦ç†ã®çŠ¶æ…‹ã‚’æ­£ç¢ºã«æŠŠæ¡ã—ã€å®‰å…¨ãªå†é–‹ã‚’å®Ÿç¾
- **è©³ç´°è¨ºæ–­**: å¤±æ•—åŸå› ã®åˆ†é¡ã¨å¯¾å¿œç­–ã®è‡ªå‹•ææ¡ˆæ©Ÿèƒ½

### 2.3 Token Service

#### 2.3.1 è¨­è¨ˆç›®çš„ã¨è²¬å‹™
**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç›®çš„**:
Solanaãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã®è¤‡é›‘ãªãƒˆãƒ¼ã‚¯ãƒ³æ“ä½œã‚’æŠ½è±¡åŒ–ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ãŒæŠ€è¡“çš„è©³ç´°ã‚’æ„è­˜ã™ã‚‹ã“ã¨ãªããƒˆãƒ¼ã‚¯ãƒ³é–¢é€£æ©Ÿèƒ½ã‚’åˆ©ç”¨ã§ãã‚‹çµ±ä¸€çš„ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã™ã‚‹ã€‚

**ä¸»è¦ãªè²¬å‹™**:
- **ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³æŠ½è±¡åŒ–**: Solanaç‰¹æœ‰ã®æŠ€è¡“çš„è¤‡é›‘æ€§ã‚’éš è”½ã—ã€ã‚·ãƒ³ãƒ—ãƒ«ãªAPIæä¾›
- **ãƒˆãƒ¼ã‚¯ãƒ³æ“ä½œçµ±åˆ**: æƒ…å ±å–å¾—ã€æ®‹é«˜ç¢ºèªã€è»¢é€å‡¦ç†ã‚’ä¸€å…ƒçš„ã«ç®¡ç†
- **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç®¡ç†**: é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆãƒ»æœ¬ç•ªç’°å¢ƒã®åˆ‡ã‚Šæ›¿ãˆã¨è¨­å®šç®¡ç†
- **ã‚¨ãƒ©ãƒ¼æ­£è¦åŒ–**: ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³å›ºæœ‰ã®ã‚¨ãƒ©ãƒ¼ã‚’ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã§ç†è§£ã—ã‚„ã™ã„å½¢å¼ã«å¤‰æ›

#### 2.3.2 ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆæ€æƒ³
**æŠ½è±¡åŒ–æˆ¦ç•¥**:
- **æŠ€è¡“çš„è©³ç´°ã®éš è”½**: Solana RPC ã®è¤‡é›‘ãª API ã‚’ç°¡æ½”ãªæ“ä½œã«æŠ½è±¡åŒ–
- **å‹å®‰å…¨æ€§**: TypeScript ã®å‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨ã—ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã®ã‚¨ãƒ©ãƒ¼æ¤œå‡ºã‚’å¼·åŒ–
- **éåŒæœŸå‡¦ç†ã®çµ±ä¸€**: ã™ã¹ã¦ã®ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³æ“ä½œã‚’ Promise ãƒ™ãƒ¼ã‚¹ã§çµ±ä¸€ã—ã€å‘¼ã³å‡ºã—å´ã®è² æ‹…ã‚’è»½æ¸›

**æ ¸å¿ƒã¨ãªã‚‹æ“ä½œã‚°ãƒ«ãƒ¼ãƒ—**:
- **æƒ…å ±å–å¾—ç³»**: ãƒˆãƒ¼ã‚¯ãƒ³ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã€æ®‹é«˜ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã®èª­ã¿å–ã‚Šå°‚ç”¨æ“ä½œ
- **ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç³»**: å®Ÿéš›ã®è³‡ç”£ç§»å‹•ã‚’ä¼´ã†æ›¸ãè¾¼ã¿æ“ä½œã®å®Ÿè¡Œ
- **æ¤œè¨¼ç³»**: ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚„ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æ€§ç¢ºèªã«ã‚ˆã‚‹äº‹å‰ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½
- **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç®¡ç†ç³»**: ç’°å¢ƒåˆ‡ã‚Šæ›¿ãˆã¨æ¥ç¶šå…ˆç®¡ç†ã®åˆ¶å¾¡æ©Ÿèƒ½

**ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®è¨­è¨ˆæ„å›³**:
- **TokenInfo**: ãƒˆãƒ¼ã‚¯ãƒ³ã®åŒ…æ‹¬çš„ãªæƒ…å ±ã‚’æ§‹é€ åŒ–ã—ã€ä¸Šä½å±¤ã§ã®åˆ¤æ–­ææ–™ã‚’æä¾›
- **TokenAccount**: æ‰€æœ‰æ¨©ã¨çŠ¶æ…‹æƒ…å ±ã‚’å«ã‚€å®Œå…¨ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¡¨ç¾
- **TokenTransfer**: ãƒãƒƒãƒè»¢é€ã«æœ€é©åŒ–ã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ§‹é€ 

#### 2.3.3 å®Ÿè£…è©³ç´°
```typescript
import { Connection, PublicKey, Transaction, sendAndConfirmTransaction } from '@solana/web3.js';
import { getOrCreateAssociatedTokenAccount, transfer, getAccount } from '@solana/spl-token';

export class TokenService implements ITokenService {
  private connection: Connection;
  private network: SolanaNetwork;

  constructor(
    private configManager: IConfigManager,
    private logger: ILogger,
    network: SolanaNetwork = 'devnet'
  ) {
    this.network = network;
    this.connection = new Connection(this.getRpcUrl(network));
  }

  async getTokenInfo(tokenAddress: string): Promise<TokenInfo> {
    try {
      const mintPubkey = new PublicKey(tokenAddress);
      const mintInfo = await this.connection.getParsedAccountInfo(mintPubkey);

      if (!mintInfo.value?.data || !('parsed' in mintInfo.value.data)) {
        throw new Error('Invalid token address');
      }

      const parsed = mintInfo.value.data.parsed.info;

      return {
        address: tokenAddress,
        name: parsed.name || 'Unknown',
        symbol: parsed.symbol || 'UNK',
        decimals: parsed.decimals,
        totalSupply: parsed.supply,
        mintAuthority: parsed.mintAuthority,
        freezeAuthority: parsed.freezeAuthority
      };
    } catch (error) {
      this.logger.error(`Failed to get token info for ${tokenAddress}:`, error);
      throw error;
    }
  }

  async getTokenBalance(walletAddress: string, tokenAddress?: string): Promise<number> {
    try {
      const walletPubkey = new PublicKey(walletAddress);

      if (!tokenAddress) {
        // SOLæ®‹é«˜å–å¾—
        const balance = await this.connection.getBalance(walletPubkey);
        return balance / 1e9; // lamports to SOL
      }

      // SPLãƒˆãƒ¼ã‚¯ãƒ³æ®‹é«˜å–å¾—
      const tokenPubkey = new PublicKey(tokenAddress);
      const tokenAccounts = await this.connection.getTokenAccountsByOwner(
        walletPubkey,
        { mint: tokenPubkey }
      );

      if (tokenAccounts.value.length === 0) return 0;

      const accountInfo = await getAccount(this.connection, tokenAccounts.value[0].pubkey);
      return Number(accountInfo.amount);
    } catch (error) {
      this.logger.error(`Failed to get token balance:`, error);
      return 0;
    }
  }

  async transferToken(tokenAddress: string, recipient: string, amount: number): Promise<string> {
    try {
      const senderKeypair = await this.configManager.getWallet();
      const mintPubkey = new PublicKey(tokenAddress);
      const recipientPubkey = new PublicKey(recipient);

      // é€ä¿¡è€…ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå–å¾—
      const senderTokenAccount = await getOrCreateAssociatedTokenAccount(
        this.connection,
        senderKeypair,
        mintPubkey,
        senderKeypair.publicKey
      );

      // å—ä¿¡è€…ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå–å¾—ã¾ãŸã¯ä½œæˆ
      const recipientTokenAccount = await getOrCreateAssociatedTokenAccount(
        this.connection,
        senderKeypair,
        mintPubkey,
        recipientPubkey
      );

      // è»¢é€å®Ÿè¡Œ
      const signature = await transfer(
        this.connection,
        senderKeypair,
        senderTokenAccount.address,
        recipientTokenAccount.address,
        senderKeypair,
        amount
      );

      this.logger.info(`Token transfer successful: ${signature}`);
      return signature;
    } catch (error) {
      this.logger.error(`Token transfer failed:`, error);
      throw error;
    }
  }

  setNetwork(network: SolanaNetwork): void {
    this.network = network;
    this.connection = new Connection(this.getRpcUrl(network));
    this.logger.info(`Switched to network: ${network}`);
  }

  getCurrentNetwork(): SolanaNetwork {
    return this.network;
  }

  validateAddress(address: string): boolean {
    try {
      new PublicKey(address);
      return true;
    } catch {
      return false;
    }
  }

  async validateTokenAddress(tokenAddress: string): Promise<boolean> {
    try {
      await this.getTokenInfo(tokenAddress);
      return true;
    } catch {
      return false;
    }
  }

  private getRpcUrl(network: SolanaNetwork): string {
    const urls = {
      'mainnet-beta': 'https://api.mainnet-beta.solana.com',
      'testnet': 'https://api.testnet.solana.com',
      'devnet': 'https://api.devnet.solana.com'
    };
    return urls[network];
  }
}
```

### 2.4 CLI Interface

#### 2.4.1 è²¬å‹™
- ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã®è§£æ
- ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®æ¤œè¨¼
- å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å‘¼ã³å‡ºã—
- çµæœã®è¡¨ç¤ºã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

#### 2.4.2 ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
```typescript
export interface ICLIInterface {
  // ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
  executeCommand(args: string[]): Promise<void>;

  // ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
  showHelp(command?: string): void;

  // å¯¾è©±çš„å…¥åŠ›
  promptUser(question: string): Promise<string>;
  confirmAction(message: string): Promise<boolean>;
}

export interface CommandDefinition {
  name: string;
  description: string;
  options: CommandOption[];
  handler: CommandHandler;
}

export interface CommandOption {
  name: string;
  alias?: string;
  description: string;
  required?: boolean;
  type: 'string' | 'number' | 'boolean';
  default?: any;
}

export type CommandHandler = (options: any) => Promise<void>;
```

#### 2.4.3 å®Ÿè£…è©³ç´°
```typescript
import { Command } from 'commander';
import inquirer from 'inquirer';
import chalk from 'chalk';

export class CLIInterface implements ICLIInterface {
  private program: Command;

  constructor(
    private walletCollector: IWalletCollector,
    private distributionEngine: IDistributionEngine,
    private configManager: IConfigManager,
    private logger: ILogger
  ) {
    this.program = new Command();
    this.setupCommands();
  }

  async executeCommand(args: string[]): Promise<void> {
    try {
      await this.program.parseAsync(args);
    } catch (error) {
      this.logger.error('Command execution failed:', error);
      console.error(chalk.red(`Error: ${error.message}`));
      process.exit(1);
    }
  }

  private setupCommands(): void {
    this.program
      .name('tributary')
      .description('Solana token distribution system')
      .version('1.0.0');

    // init ã‚³ãƒãƒ³ãƒ‰
    this.program
      .command('init')
      .description('Initialize project configuration')
      .option('-n, --name <name>', 'Project name')
      .option('--network <network>', 'Solana network', 'devnet')
      .action(this.handleInit.bind(this));

    // collect ã‚³ãƒãƒ³ãƒ‰
    this.program
      .command('collect')
      .description('Collect token holder wallets')
      .requiredOption('-t, --token <address>', 'Token address')
      .option('--threshold <amount>', 'Minimum balance threshold', '0')
      .option('--cache', 'Use cached data if available')
      .action(this.handleCollect.bind(this));

    // distribute ã‚³ãƒãƒ³ãƒ‰
    this.program
      .command('distribute')
      .description('Execute token distribution')
      .requiredOption('-t, --token <address>', 'Distribution token address')
      .requiredOption('-a, --amount <amount>', 'Total amount to distribute')
      .option('-s, --source <address>', 'Source token for ratio calculation')
      .option('--dry-run', 'Simulate distribution without execution')
      .option('--batch-size <size>', 'Batch size for transactions', '10')
      .action(this.handleDistribute.bind(this));

    // config ã‚³ãƒãƒ³ãƒ‰
    this.program
      .command('config')
      .description('Show current configuration')
      .action(this.handleConfig.bind(this));
  }

  private async handleInit(options: any): Promise<void> {
    console.log(chalk.blue('ğŸš€ Initializing Tributary project...'));

    const config = {
      projectName: options.name || await this.promptUser('Project name:'),
      network: options.network,
      walletPath: await this.promptUser('Wallet file path (or press enter to create new):')
    };

    await this.configManager.initialize(config);
    console.log(chalk.green('âœ… Project initialized successfully!'));
  }

  private async handleCollect(options: any): Promise<void> {
    console.log(chalk.blue(`ğŸ” Collecting holders for token: ${options.token}`));

    const params: CollectHoldersParams = {
      tokenAddress: options.token,
      minBalance: parseFloat(options.threshold),
      useCache: options.cache
    };

    const holders = await this.walletCollector.collectHolders(params);

    console.log(chalk.green(`âœ… Found ${holders.length} token holders`));
    console.table(holders.slice(0, 10).map(h => ({
      Address: h.address.slice(0, 8) + '...',
      Balance: h.balance.toLocaleString(),
      Percentage: h.percentage.toFixed(2) + '%'
    })));

    if (holders.length > 10) {
      console.log(chalk.gray(`... and ${holders.length - 10} more holders`));
    }
  }

  private async handleDistribute(options: any): Promise<void> {
    console.log(chalk.blue('ğŸ’° Preparing token distribution...'));

    // ä¿æœ‰è€…æƒ…å ±å–å¾—
    const sourceToken = options.source || options.token;
    const holders = await this.walletCollector.collectHolders({
      tokenAddress: sourceToken,
      useCache: true
    });

    if (holders.length === 0) {
      throw new Error('No token holders found. Run collect command first.');
    }

    const params: DistributionParams = {
      sourceToken,
      targetToken: options.token,
      totalAmount: parseFloat(options.amount),
      recipients: holders,
      dryRun: options.dryRun,
      batchSize: parseInt(options.batchSize)
    };

    // ç¢ºèª
    if (!options.dryRun) {
      const confirmed = await this.confirmAction(
        `Distribute ${params.totalAmount} tokens to ${holders.length} recipients?`
      );
      if (!confirmed) {
        console.log(chalk.yellow('Distribution cancelled'));
        return;
      }
    }

    // å®Ÿè¡Œ
    const result = await this.distributionEngine.executeDistribution(params);

    // çµæœè¡¨ç¤º
    this.displayDistributionResult(result);
  }

  private async handleConfig(): Promise<void> {
    const config = await this.configManager.getConfig();
    console.log(chalk.blue('ğŸ“‹ Current Configuration:'));
    console.log(JSON.stringify(config, null, 2));
  }

  async promptUser(question: string): Promise<string> {
    const { answer } = await inquirer.prompt([
      {
        type: 'input',
        name: 'answer',
        message: question
      }
    ]);
    return answer;
  }

  async confirmAction(message: string): Promise<boolean> {
    const { confirmed } = await inquirer.prompt([
      {
        type: 'confirm',
        name: 'confirmed',
        message: message
      }
    ]);
    return confirmed;
  }

  private displayDistributionResult(result: DistributionResult): void {
    console.log(chalk.blue('\nğŸ“Š Distribution Results:'));
    console.log(`Status: ${this.getStatusColor(result.status)(result.status.toUpperCase())}`);
    console.log(`Total Transactions: ${result.totalTransactions}`);
    console.log(`Successful: ${chalk.green(result.successCount)}`);
    console.log(`Failed: ${chalk.red(result.failedCount)}`);
    console.log(`Execution Time: ${result.executionTime}ms`);
    console.log(`Gas Used: ${result.gasUsed}`);

    if (result.failedCount > 0) {
      console.log(chalk.red('\nâŒ Failed Transactions:'));
      result.transactions
        .filter(t => t.status === 'failed')
        .forEach(t => {
          console.log(`  ${t.recipient}: ${t.error}`);
        });
    }
  }

  private getStatusColor(status: string) {
    switch (status) {
      case 'success': return chalk.green;
      case 'partial': return chalk.yellow;
      case 'failed': return chalk.red;
      default: return chalk.gray;
    }
  }

  showHelp(command?: string): void {
    if (command) {
      this.program.commands.find(cmd => cmd.name() === command)?.help();
    } else {
      this.program.help();
    }
  }
}
```

### 2.5 Config Manager

#### 2.5.1 è²¬å‹™
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿æ›¸ã
- è¨­å®šå€¤ã®æ¤œè¨¼
- ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæƒ…å ±ã®æš—å·åŒ–ä¿å­˜
- ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†

#### 2.5.2 ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
```typescript
export interface IConfigManager {
  // åˆæœŸåŒ–
  initialize(config: InitialConfig): Promise<void>;

  // è¨­å®šç®¡ç†
  getConfig(): Promise<TributaryConfig>;
  updateConfig(updates: Partial<TributaryConfig>): Promise<void>;

  // ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç®¡ç†
  getWallet(): Promise<Keypair>;
  setWallet(keypair: Keypair): Promise<void>;

  // æ¤œè¨¼
  validateConfig(): Promise<boolean>;
  configExists(): boolean;
}

export interface TributaryConfig {
  projectName: string;
  network: SolanaNetwork;
  walletPath: string;
  rpcUrl?: string;
  logLevel: 'debug' | 'info' | 'warn' | 'error';
  cacheEnabled: boolean;
  cacheExpiry: number;
  batchSize: number;
  retryAttempts: number;
  retryDelay: number;
}

export interface InitialConfig {
  projectName: string;
  network: SolanaNetwork;
  walletPath?: string;
}
```

#### 2.5.3 å®Ÿè£…è©³ç´°
```typescript
import * as fs from 'fs/promises';
import * as path from 'path';
import * as os from 'os';
import { Keypair } from '@solana/web3.js';
import * as crypto from 'crypto';

export class ConfigManager implements IConfigManager {
  private configDir: string;
  private configFile: string;
  private walletFile: string;

  constructor(private logger: ILogger) {
    this.configDir = path.join(os.homedir(), '.tributary');
    this.configFile = path.join(this.configDir, 'config.json');
    this.walletFile = path.join(this.configDir, 'wallet.enc');
  }

  async initialize(config: InitialConfig): Promise<void> {
    try {
      // è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
      await fs.mkdir(this.configDir, { recursive: true });

      // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šä½œæˆ
      const defaultConfig: TributaryConfig = {
        projectName: config.projectName,
        network: config.network,
        walletPath: config.walletPath || this.walletFile,
        logLevel: 'info',
        cacheEnabled: true,
        cacheExpiry: 3600, // 1æ™‚é–“
        batchSize: 10,
        retryAttempts: 3,
        retryDelay: 1000
      };

      await this.saveConfig(defaultConfig);

      // ã‚¦ã‚©ãƒ¬ãƒƒãƒˆå‡¦ç†
      if (config.walletPath) {
        // æ—¢å­˜ã‚¦ã‚©ãƒ¬ãƒƒãƒˆèª­ã¿è¾¼ã¿
        const walletData = await fs.readFile(config.walletPath);
        const keypair = Keypair.fromSecretKey(new Uint8Array(JSON.parse(walletData.toString())));
        await this.setWallet(keypair);
      } else {
        // æ–°è¦ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆ
        const keypair = Keypair.generate();
        await this.setWallet(keypair);

        console.log(`New wallet created: ${keypair.publicKey.toBase58()}`);
        console.log('Please fund this wallet before using distribution features.');
      }

      this.logger.info(`Configuration initialized: ${this.configFile}`);
    } catch (error) {
      this.logger.error('Failed to initialize configuration:', error);
      throw error;
    }
  }

  async getConfig(): Promise<TributaryConfig> {
    try {
      const data = await fs.readFile(this.configFile, 'utf8');
      return JSON.parse(data);
    } catch (error) {
      throw new Error('Configuration file not found. Run "tributary init" first.');
    }
  }

  async updateConfig(updates: Partial<TributaryConfig>): Promise<void> {
    const currentConfig = await this.getConfig();
    const newConfig = { ...currentConfig, ...updates };
    await this.saveConfig(newConfig);
  }

  async getWallet(): Promise<Keypair> {
    try {
      const encryptedData = await fs.readFile(this.walletFile);
      const decrypted = this.decrypt(encryptedData);
      const secretKey = new Uint8Array(JSON.parse(decrypted));
      return Keypair.fromSecretKey(secretKey);
    } catch (error) {
      throw new Error('Wallet file not found or corrupted. Run "tributary init" first.');
    }
  }

  async setWallet(keypair: Keypair): Promise<void> {
    const secretKeyArray = Array.from(keypair.secretKey);
    const secretKeyJson = JSON.stringify(secretKeyArray);
    const encrypted = this.encrypt(secretKeyJson);

    await fs.writeFile(this.walletFile, encrypted);
    await fs.chmod(this.walletFile, 0o600); // èª­ã¿æ›¸ãæ¨©é™ã‚’æ‰€æœ‰è€…ã®ã¿ã«åˆ¶é™

    this.logger.info('Wallet saved securely');
  }

  async validateConfig(): Promise<boolean> {
    try {
      const config = await this.getConfig();

      // å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯
      if (!config.projectName || !config.network || !config.walletPath) {
        return false;
      }

      // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å€¤ãƒã‚§ãƒƒã‚¯
      if (!['mainnet-beta', 'testnet', 'devnet'].includes(config.network)) {
        return false;
      }

      // ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯
      try {
        await this.getWallet();
      } catch {
        return false;
      }

      return true;
    } catch {
      return false;
    }
  }

  configExists(): boolean {
    try {
      return require('fs').existsSync(this.configFile);
    } catch {
      return false;
    }
  }

  private async saveConfig(config: TributaryConfig): Promise<void> {
    const data = JSON.stringify(config, null, 2);
    await fs.writeFile(this.configFile, data, 'utf8');
  }

  private encrypt(text: string): Buffer {
    const algorithm = 'aes-256-gcm';
    const password = this.getEncryptionKey();
    const salt = crypto.randomBytes(16);
    const key = crypto.pbkdf2Sync(password, salt, 10000, 32, 'sha256');
    const iv = crypto.randomBytes(16);

    const cipher = crypto.createCipher(algorithm, key);
    cipher.setAAD(salt);

    let encrypted = cipher.update(text, 'utf8', 'hex');
    encrypted += cipher.final('hex');

    const tag = cipher.getAuthTag();

    return Buffer.concat([salt, iv, tag, Buffer.from(encrypted, 'hex')]);
  }

  private decrypt(encryptedData: Buffer): string {
    const algorithm = 'aes-256-gcm';
    const password = this.getEncryptionKey();

    const salt = encryptedData.slice(0, 16);
    const iv = encryptedData.slice(16, 32);
    const tag = encryptedData.slice(32, 48);
    const encrypted = encryptedData.slice(48);

    const key = crypto.pbkdf2Sync(password, salt, 10000, 32, 'sha256');

    const decipher = crypto.createDecipher(algorithm, key);
    decipher.setAAD(salt);
    decipher.setAuthTag(tag);

    let decrypted = decipher.update(encrypted, null, 'utf8');
    decrypted += decipher.final('utf8');

    return decrypted;
  }

  private getEncryptionKey(): string {
    // ç’°å¢ƒå¤‰æ•°ã¾ãŸã¯ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±ã‹ã‚‰æš—å·åŒ–ã‚­ãƒ¼ã‚’ç”Ÿæˆ
    return process.env.TRIBUTARY_KEY || `${os.hostname()}-${os.userInfo().username}`;
  }
}
```

### 2.6 Report Generator

#### 2.6.1 è²¬å‹™
- é…å¸ƒçµæœã®ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- å±¥æ­´ç®¡ç†
- å„ç¨®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã®å‡ºåŠ›
- çµ±è¨ˆæƒ…å ±ã®è¨ˆç®—

#### 2.6.2 ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
```typescript
export interface IReportGenerator {
  // ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
  generateDistributionReport(result: DistributionResult): Promise<Report>;
  generateSummaryReport(filter?: ReportFilter): Promise<SummaryReport>;

  // å‡ºåŠ›
  exportReport(report: Report, format: ReportFormat, outputPath?: string): Promise<string>;

  // å±¥æ­´ç®¡ç†
  saveDistributionRecord(result: DistributionResult): Promise<void>;
  getDistributionHistory(filter?: ReportFilter): Promise<DistributionRecord[]>;
}

export interface Report {
  id: string;
  title: string;
  generatedAt: Date;
  data: any;
  metadata: ReportMetadata;
}

export interface ReportMetadata {
  version: string;
  generator: string;
  network: string;
  totalRecords: number;
}

export interface ReportFilter {
  startDate?: Date;
  endDate?: Date;
  status?: string[];
  tokenAddress?: string;
  limit?: number;
  offset?: number;
}

export type ReportFormat = 'json' | 'csv' | 'html' | 'pdf';
```

#### 2.6.3 å®Ÿè£…è©³ç´°
```typescript
import * as fs from 'fs/promises';
import * as path from 'path';
import { createObjectCsvWriter } from 'csv-writer';

export class ReportGenerator implements IReportGenerator {
  private reportsDir: string;

  constructor(
    private configManager: IConfigManager,
    private logger: ILogger
  ) {
    this.reportsDir = path.join(process.cwd(), 'reports');
  }

  async generateDistributionReport(result: DistributionResult): Promise<Report> {
    const report: Report = {
      id: result.distributionId,
      title: `Distribution Report - ${result.distributionId}`,
      generatedAt: new Date(),
      data: {
        summary: {
          distributionId: result.distributionId,
          status: result.status,
          totalTransactions: result.totalTransactions,
          successCount: result.successCount,
          failedCount: result.failedCount,
          successRate: ((result.successCount / result.totalTransactions) * 100).toFixed(2),
          totalAmount: result.totalAmount,
          gasUsed: result.gasUsed,
          executionTime: result.executionTime,
          executedAt: new Date()
        },
        transactions: result.transactions.map(tx => ({
          recipient: tx.recipient,
          amount: tx.amount,
          status: tx.status,
          signature: tx.signature,
          gasUsed: tx.gasUsed,
          error: tx.error
        })),
        statistics: this.calculateStatistics(result)
      },
      metadata: {
        version: '1.0.0',
        generator: 'Tributary Report Generator',
        network: (await this.configManager.getConfig()).network,
        totalRecords: result.transactions.length
      }
    };

    return report;
  }

  async generateSummaryReport(filter?: ReportFilter): Promise<SummaryReport> {
    const history = await this.getDistributionHistory(filter);

    const summary: SummaryReport = {
      reportId: `summary-${Date.now()}`,
      generatedAt: new Date(),
      period: {
        startDate: filter?.startDate || new Date(0),
        endDate: filter?.endDate || new Date()
      },
      totals: {
        distributions: history.length,
        successfulDistributions: history.filter(h => h.status === 'success').length,
        totalTransactions: history.reduce((sum, h) => sum + h.totalTransactions, 0),
        totalAmount: history.reduce((sum, h) => sum + h.totalAmount, 0),
        totalGasUsed: history.reduce((sum, h) => sum + h.gasUsed, 0)
      },
      averages: {
        transactionsPerDistribution: history.length > 0 ?
          history.reduce((sum, h) => sum + h.totalTransactions, 0) / history.length : 0,
        executionTime: history.length > 0 ?
          history.reduce((sum, h) => sum + h.executionTime, 0) / history.length : 0,
        gasPerTransaction: 0 // è¨ˆç®—
      },
      distributions: history
    };

    // å¹³å‡ã‚¬ã‚¹ä½¿ç”¨é‡è¨ˆç®—
    const totalTx = summary.totals.totalTransactions;
    summary.averages.gasPerTransaction = totalTx > 0 ?
      summary.totals.totalGasUsed / totalTx : 0;

    return summary;
  }

  async exportReport(report: Report, format: ReportFormat, outputPath?: string): Promise<string> {
    await fs.mkdir(this.reportsDir, { recursive: true });

    const filename = outputPath || this.generateFilename(report.id, format);
    const fullPath = path.resolve(filename);

    switch (format) {
      case 'json':
        await this.exportJson(report, fullPath);
        break;
      case 'csv':
        await this.exportCsv(report, fullPath);
        break;
      case 'html':
        await this.exportHtml(report, fullPath);
        break;
      default:
        throw new Error(`Unsupported format: ${format}`);
    }

    this.logger.info(`Report exported: ${fullPath}`);
    return fullPath;
  }

  private async exportJson(report: Report, filePath: string): Promise<void> {
    const json = JSON.stringify(report, null, 2);
    await fs.writeFile(filePath, json, 'utf8');
  }

  private async exportCsv(report: Report, filePath: string): Promise<void> {
    const transactions = report.data.transactions;

    const csvWriter = createObjectCsvWriter({
      path: filePath,
      header: [
        { id: 'recipient', title: 'Recipient' },
        { id: 'amount', title: 'Amount' },
        { id: 'status', title: 'Status' },
        { id: 'signature', title: 'Signature' },
        { id: 'gasUsed', title: 'Gas Used' },
        { id: 'error', title: 'Error' }
      ]
    });

    await csvWriter.writeRecords(transactions);
  }

  private async exportHtml(report: Report, filePath: string): Promise<void> {
    const html = this.generateHtmlReport(report);
    await fs.writeFile(filePath, html, 'utf8');
  }

  private generateHtmlReport(report: Report): string {
    const { summary, transactions, statistics } = report.data;

    return `
<!DOCTYPE html>
<html>
<head>
    <title>${report.title}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .summary { background: #f5f5f5; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
        .statistics { background: #e8f4fd; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .success { color: green; }
        .failed { color: red; }
    </style>
</head>
<body>
    <h1>${report.title}</h1>
    <p>Generated: ${report.generatedAt.toISOString()}</p>

    <div class="summary">
        <h2>Summary</h2>
        <p><strong>Distribution ID:</strong> ${summary.distributionId}</p>
        <p><strong>Status:</strong> <span class="${summary.status}">${summary.status.toUpperCase()}</span></p>
        <p><strong>Success Rate:</strong> ${summary.successRate}%</p>
        <p><strong>Total Amount:</strong> ${summary.totalAmount.toLocaleString()}</p>
        <p><strong>Execution Time:</strong> ${summary.executionTime}ms</p>
        <p><strong>Gas Used:</strong> ${summary.gasUsed.toLocaleString()}</p>
    </div>

    <div class="statistics">
        <h2>Statistics</h2>
        <p><strong>Average Amount:</strong> ${statistics.averageAmount.toFixed(2)}</p>
        <p><strong>Median Amount:</strong> ${statistics.medianAmount.toFixed(2)}</p>
        <p><strong>Min Amount:</strong> ${statistics.minAmount}</p>
        <p><strong>Max Amount:</strong> ${statistics.maxAmount}</p>
    </div>

    <h2>Transactions</h2>
    <table>
        <thead>
            <tr>
                <th>Recipient</th>
                <th>Amount</th>
                <th>Status</th>
                <th>Signature</th>
                <th>Gas Used</th>
                <th>Error</th>
            </tr>
        </thead>
        <tbody>
            ${transactions.map(tx => `
                <tr>
                    <td>${tx.recipient}</td>
                    <td>${tx.amount.toLocaleString()}</td>
                    <td class="${tx.status}">${tx.status.toUpperCase()}</td>
                    <td>${tx.signature || '-'}</td>
                    <td>${tx.gasUsed || '-'}</td>
                    <td>${tx.error || '-'}</td>
                </tr>
            `).join('')}
        </tbody>
    </table>
</body>
</html>
    `;
  }

  private calculateStatistics(result: DistributionResult): any {
    const amounts = result.transactions.map(tx => tx.amount);
    amounts.sort((a, b) => a - b);

    return {
      averageAmount: amounts.reduce((sum, amt) => sum + amt, 0) / amounts.length,
      medianAmount: amounts[Math.floor(amounts.length / 2)],
      minAmount: Math.min(...amounts),
      maxAmount: Math.max(...amounts),
      standardDeviation: this.calculateStandardDeviation(amounts)
    };
  }

  private calculateStandardDeviation(values: number[]): number {
    const avg = values.reduce((sum, val) => sum + val, 0) / values.length;
    const squareDiffs = values.map(val => Math.pow(val - avg, 2));
    const avgSquareDiff = squareDiffs.reduce((sum, sq) => sum + sq, 0) / squareDiffs.length;
    return Math.sqrt(avgSquareDiff);
  }

  private generateFilename(id: string, format: ReportFormat): string {
    const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
    return path.join(this.reportsDir, `${id}-${timestamp}.${format}`);
  }

  async saveDistributionRecord(result: DistributionResult): Promise<void> {
    // å®Ÿè£…: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¾ãŸã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ä¿å­˜
    const record = {
      id: result.distributionId,
      status: result.status,
      totalTransactions: result.totalTransactions,
      successCount: result.successCount,
      failedCount: result.failedCount,
      totalAmount: result.totalAmount,
      gasUsed: result.gasUsed,
      executionTime: result.executionTime,
      createdAt: new Date(),
      data: result
    };

    const recordsFile = path.join(this.reportsDir, 'distribution-history.jsonl');
    await fs.appendFile(recordsFile, JSON.stringify(record) + '\n', 'utf8');
  }

  async getDistributionHistory(filter?: ReportFilter): Promise<DistributionRecord[]> {
    // å®Ÿè£…: ä¿å­˜ã•ã‚ŒãŸå±¥æ­´ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã¨ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    const recordsFile = path.join(this.reportsDir, 'distribution-history.jsonl');

    try {
      const data = await fs.readFile(recordsFile, 'utf8');
      const lines = data.trim().split('\n').filter(line => line);
      let records = lines.map(line => JSON.parse(line));

      // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
      if (filter) {
        if (filter.startDate) {
          records = records.filter(r => new Date(r.createdAt) >= filter.startDate!);
        }
        if (filter.endDate) {
          records = records.filter(r => new Date(r.createdAt) <= filter.endDate!);
        }
        if (filter.status?.length) {
          records = records.filter(r => filter.status!.includes(r.status));
        }
        if (filter.limit) {
          records = records.slice(filter.offset || 0, (filter.offset || 0) + filter.limit);
        }
      }

      return records;
    } catch (error) {
      this.logger.warn('No distribution history found');
      return [];
    }
  }
}

interface SummaryReport {
  reportId: string;
  generatedAt: Date;
  period: {
    startDate: Date;
    endDate: Date;
  };
  totals: {
    distributions: number;
    successfulDistributions: number;
    totalTransactions: number;
    totalAmount: number;
    totalGasUsed: number;
  };
  averages: {
    transactionsPerDistribution: number;
    executionTime: number;
    gasPerTransaction: number;
  };
  distributions: DistributionRecord[];
}

interface DistributionRecord {
  id: string;
  status: string;
  totalTransactions: number;
  successCount: number;
  failedCount: number;
  totalAmount: number;
  gasUsed: number;
  executionTime: number;
  createdAt: Date;
}
```

## 3. ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ

### 3.1 ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

#### 3.1.1 ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä¿æœ‰è€…ãƒ‡ãƒ¼ã‚¿
```typescript
interface WalletHolder {
  address: string;           // ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ (ä¸»é”®)
  balance: number;           // ãƒˆãƒ¼ã‚¯ãƒ³ä¿æœ‰é‡
  percentage: number;        // å…¨ä½“ã«å¯¾ã™ã‚‹ä¿æœ‰å‰²åˆ
  lastUpdated: Date;         // æœ€çµ‚æ›´æ–°æ—¥æ™‚
  tokenAddress: string;      // å¯¾è±¡ãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹
  isValid: boolean;          // ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®æœ‰åŠ¹æ€§
}
```

#### 3.1.2 é…å¸ƒçµæœãƒ‡ãƒ¼ã‚¿
```typescript
interface DistributionResult {
  distributionId: string;           // é…å¸ƒID (ä¸»é”®)
  sourceToken: string;              // é…å¸ƒå…ƒãƒˆãƒ¼ã‚¯ãƒ³
  targetToken: string;              // é…å¸ƒå…ˆãƒˆãƒ¼ã‚¯ãƒ³
  totalAmount: number;              // ç·é…å¸ƒé‡
  status: DistributionStatus;       // é…å¸ƒã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  totalTransactions: number;        // ç·ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ•°
  successCount: number;             // æˆåŠŸæ•°
  failedCount: number;              // å¤±æ•—æ•°
  gasUsed: number;                  // ä½¿ç”¨ã‚¬ã‚¹é‡
  executionTime: number;            // å®Ÿè¡Œæ™‚é–“(ms)
  createdAt: Date;                  // ä½œæˆæ—¥æ™‚
  completedAt?: Date;               // å®Œäº†æ—¥æ™‚
  transactions: TransactionResult[]; // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è©³ç´°
}

type DistributionStatus = 'pending' | 'running' | 'success' | 'partial' | 'failed' | 'cancelled';
```

#### 3.1.3 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³çµæœãƒ‡ãƒ¼ã‚¿
```typescript
interface TransactionResult {
  id: string;                // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ID
  distributionId: string;    // é…å¸ƒID (å¤–æ¥é”®)
  recipient: string;         // å—ä¿¡è€…ã‚¢ãƒ‰ãƒ¬ã‚¹
  amount: number;            // é…å¸ƒé‡
  signature?: string;        // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç½²å
  status: TransactionStatus; // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  gasUsed?: number;          // ä½¿ç”¨ã‚¬ã‚¹é‡
  error?: string;            // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  createdAt: Date;           // ä½œæˆæ—¥æ™‚
  completedAt?: Date;        // å®Œäº†æ—¥æ™‚
  retryCount: number;        // ãƒªãƒˆãƒ©ã‚¤å›æ•°
}

type TransactionStatus = 'pending' | 'confirmed' | 'failed';
```

#### 3.1.4 è¨­å®šãƒ‡ãƒ¼ã‚¿
```typescript
interface TributaryConfig {
  version: string;                  // è¨­å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³
  projectName: string;              // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
  network: SolanaNetwork;           // Solanaãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
  walletPath: string;               // ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
  rpcUrl?: string;                  // ã‚«ã‚¹ã‚¿ãƒ RPC URL
  logLevel: LogLevel;               // ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
  cacheEnabled: boolean;            // ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ‰åŠ¹/ç„¡åŠ¹
  cacheExpiry: number;              // ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ‰åŠ¹æœŸé™(ç§’)
  batchSize: number;                // ãƒãƒƒãƒã‚µã‚¤ã‚º
  retryAttempts: number;            // ãƒªãƒˆãƒ©ã‚¤å›æ•°
  retryDelay: number;               // ãƒªãƒˆãƒ©ã‚¤é–“éš”(ms)
  notificationWebhook?: string;     // é€šçŸ¥Webhook URL
  createdAt: Date;                  // ä½œæˆæ—¥æ™‚
  updatedAt: Date;                  // æ›´æ–°æ—¥æ™‚
}

type LogLevel = 'debug' | 'info' | 'warn' | 'error';
type SolanaNetwork = 'mainnet-beta' | 'testnet' | 'devnet';
```

### 3.2 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

#### 3.2.1 ãƒ¡ã‚¤ãƒ³è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
**å ´æ‰€**: `~/.tributary/config.json`
```json
{
  "version": "1.0.0",
  "projectName": "MyProject",
  "network": "devnet",
  "walletPath": "/home/user/.tributary/wallet.enc",
  "rpcUrl": null,
  "logLevel": "info",
  "cacheEnabled": true,
  "cacheExpiry": 3600,
  "batchSize": 10,
  "retryAttempts": 3,
  "retryDelay": 1000,
  "notificationWebhook": null,
  "createdAt": "2025-09-18T09:00:00.000Z",
  "updatedAt": "2025-09-18T09:00:00.000Z"
}
```

#### 3.2.2 ç’°å¢ƒå¤‰æ•°è¨­å®š
**å ´æ‰€**: `~/.tributary/.env`
```bash
# Solana RPC Settings
SOLANA_RPC_URL=https://api.devnet.solana.com
SOLANA_WS_URL=wss://api.devnet.solana.com

# Security
TRIBUTARY_ENCRYPTION_KEY=custom-encryption-key
WALLET_PASSWORD=optional-wallet-password

# External APIs
COINGECKO_API_KEY=optional-api-key
JUPITER_API_KEY=optional-api-key

# Notifications
SLACK_WEBHOOK_URL=optional-slack-webhook
DISCORD_WEBHOOK_URL=optional-discord-webhook

# Performance
MAX_CONCURRENT_REQUESTS=50
REQUEST_TIMEOUT=30000
CACHE_SIZE_LIMIT=100
```

#### 3.2.3 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ¥è¨­å®š
**å ´æ‰€**: `./tributary.config.json` (ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª)
```json
{
  "project": {
    "name": "ProjectSpecificName",
    "description": "Project specific configuration"
  },
  "tokens": {
    "primary": "TokenAddressHere",
    "reward": ["USDCAddress", "USDTAddress"]
  },
  "distribution": {
    "schedule": "weekly",
    "defaultAmount": 1000,
    "minHolders": 10,
    "excludeAddresses": ["address1", "address2"]
  },
  "notifications": {
    "onSuccess": true,
    "onFailure": true,
    "onPartial": true,
    "channels": ["email", "slack"]
  }
}
```

### 3.3 ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

#### 3.3.1 ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
```
~/.tributary/logs/
â”œâ”€â”€ application.log          # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°
â”œâ”€â”€ error.log               # ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
â”œâ”€â”€ distribution.log        # é…å¸ƒå®Ÿè¡Œãƒ­ã‚°
â”œâ”€â”€ transaction.log         # ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ­ã‚°
â”œâ”€â”€ audit.log              # ç›£æŸ»ãƒ­ã‚°
â””â”€â”€ archive/               # ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ­ã‚°
    â”œâ”€â”€ 2025-09-18/
    â””â”€â”€ 2025-09-17/
```

#### 3.3.2 ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
```json
{
  "timestamp": "2025-09-18T09:00:00.000Z",
  "level": "INFO",
  "component": "DistributionEngine",
  "message": "Starting distribution: dist-123456",
  "metadata": {
    "distributionId": "dist-123456",
    "tokenAddress": "TokenAddressHere",
    "recipientCount": 150,
    "totalAmount": 10000
  },
  "correlationId": "req-123456",
  "userId": "user-id",
  "sessionId": "session-123"
}
```

#### 3.3.3 ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
```typescript
interface LogRotationConfig {
  maxFileSize: string;        // '10MB'
  maxFiles: number;          // 30
  datePattern: string;       // 'YYYY-MM-DD'
  auditFile: string;         // 'audit.json'
  compress: boolean;         // true
  archiveDirectory: string;  // './archive'
}
```

### 3.4 ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­è¨ˆ

#### 3.4.1 ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ§‹é€ 
```
~/.tributary/cache/
â”œâ”€â”€ holders/               # ãƒˆãƒ¼ã‚¯ãƒ³ä¿æœ‰è€…ã‚­ãƒ£ãƒƒã‚·ãƒ¥
â”‚   â”œâ”€â”€ {tokenAddress}.json
â”‚   â””â”€â”€ metadata.json
â”œâ”€â”€ tokens/               # ãƒˆãƒ¼ã‚¯ãƒ³æƒ…å ±ã‚­ãƒ£ãƒƒã‚·ãƒ¥
â”‚   â”œâ”€â”€ {tokenAddress}.json
â”‚   â””â”€â”€ metadata.json
â”œâ”€â”€ prices/               # ä¾¡æ ¼æƒ…å ±ã‚­ãƒ£ãƒƒã‚·ãƒ¥
â”‚   â”œâ”€â”€ latest.json
â”‚   â””â”€â”€ metadata.json
â””â”€â”€ transactions/         # ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³çŠ¶æ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥
    â”œâ”€â”€ pending.json
    â””â”€â”€ metadata.json
```

#### 3.4.2 ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¨ãƒ³ãƒˆãƒªå½¢å¼
```typescript
interface CacheEntry<T> {
  key: string;              // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼
  data: T;                  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ‡ãƒ¼ã‚¿
  createdAt: Date;          // ä½œæˆæ—¥æ™‚
  expiresAt: Date;          // æœ‰åŠ¹æœŸé™
  accessCount: number;      // ã‚¢ã‚¯ã‚»ã‚¹å›æ•°
  lastAccessedAt: Date;     // æœ€çµ‚ã‚¢ã‚¯ã‚»ã‚¹æ—¥æ™‚
  tags: string[];           // ã‚¿ã‚° (ã‚°ãƒ«ãƒ¼ãƒ—å‰Šé™¤ç”¨)
}

interface CacheMetadata {
  totalEntries: number;     // ç·ã‚¨ãƒ³ãƒˆãƒªæ•°
  totalSize: number;        // ç·ã‚µã‚¤ã‚º (bytes)
  lastCleanup: Date;        // æœ€çµ‚ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æ—¥æ™‚
  hitRate: number;          // ãƒ’ãƒƒãƒˆç‡
}
```

## 4. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ

### 4.1 CLI ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

#### 4.1.1 ã‚³ãƒãƒ³ãƒ‰ä½“ç³»
```bash
tributary [global-options] <command> [command-options]

Global Options:
  --config <path>           # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
  --network <network>       # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æŒ‡å®š
  --verbose, -v            # è©³ç´°å‡ºåŠ›
  --quiet, -q              # æœ€å°å‡ºåŠ›
  --help, -h               # ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
  --version, -V            # ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡¨ç¤º

Commands:
  init                     # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–
  collect                  # ã‚¦ã‚©ãƒ¬ãƒƒãƒˆåé›†
  distribute              # é…å¸ƒå®Ÿè¡Œ
  config                  # è¨­å®šç®¡ç†
  report                  # ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
  history                 # å±¥æ­´è¡¨ç¤º
  validate                # æ¤œè¨¼
```

#### 4.1.2 è©³ç´°ã‚³ãƒãƒ³ãƒ‰ä»•æ§˜
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–
tributary init [options]
  -n, --name <name>        # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
  --network <network>      # Solanaãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
  --wallet <path>          # ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
  --force                  # æ—¢å­˜è¨­å®šã®ä¸Šæ›¸ã

# ã‚¦ã‚©ãƒ¬ãƒƒãƒˆåé›†
tributary collect [options]
  -t, --token <address>    # ãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ (å¿…é ˆ)
  --min-balance <amount>   # æœ€å°ä¿æœ‰é‡
  --max-balance <amount>   # æœ€å¤§ä¿æœ‰é‡
  --output <path>          # å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
  --format <format>        # å‡ºåŠ›å½¢å¼ (json|csv)
  --cache                  # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨
  --refresh               # ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°

# é…å¸ƒå®Ÿè¡Œ
tributary distribute [options]
  -t, --token <address>    # é…å¸ƒãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ (å¿…é ˆ)
  -a, --amount <amount>    # é…å¸ƒç·é‡ (å¿…é ˆ)
  -s, --source <address>   # åŸºæº–ãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹
  --recipients <path>      # å—ä¿¡è€…ãƒªã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
  --batch-size <size>      # ãƒãƒƒãƒã‚µã‚¤ã‚º
  --dry-run               # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
  --auto-confirm          # è‡ªå‹•ç¢ºèª
  --report <path>         # ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›ãƒ‘ã‚¹

# è¨­å®šç®¡ç†
tributary config <subcommand> [options]
  show                     # è¨­å®šè¡¨ç¤º
  set <key> <value>        # è¨­å®šå¤‰æ›´
  get <key>               # è¨­å®šå–å¾—
  reset                   # è¨­å®šãƒªã‚»ãƒƒãƒˆ
  export <path>           # è¨­å®šã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
  import <path>           # è¨­å®šã‚¤ãƒ³ãƒãƒ¼ãƒˆ

# ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
tributary report [options]
  --distribution <id>      # é…å¸ƒIDæŒ‡å®š
  --format <format>        # å‡ºåŠ›å½¢å¼ (json|csv|html)
  --output <path>          # å‡ºåŠ›ãƒ‘ã‚¹
  --summary               # ã‚µãƒãƒªãƒ¼ãƒ¬ãƒãƒ¼ãƒˆ
  --period <days>         # æœŸé–“æŒ‡å®š

# å±¥æ­´è¡¨ç¤º
tributary history [options]
  --limit <count>          # è¡¨ç¤ºä»¶æ•°
  --status <status>        # ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ«ã‚¿
  --token <address>        # ãƒˆãƒ¼ã‚¯ãƒ³ãƒ•ã‚£ãƒ«ã‚¿
  --format <format>        # å‡ºåŠ›å½¢å¼

# æ¤œè¨¼
tributary validate [options]
  --config                # è¨­å®šæ¤œè¨¼
  --wallet                # ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¤œè¨¼
  --token <address>       # ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼
  --network               # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šæ¤œè¨¼
```

### 4.2 Solana RPC ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

#### 4.2.1 RPCæ¥ç¶šç®¡ç†
```typescript
interface SolanaRPCManager {
  // æ¥ç¶šç®¡ç†
  connect(network: SolanaNetwork, customUrl?: string): Promise<void>;
  disconnect(): Promise<void>;
  isConnected(): boolean;
  getConnection(): Connection;

  // ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
  checkHealth(): Promise<RPCHealthStatus>;
  getLatestBlockhash(): Promise<string>;
  getSlot(): Promise<number>;

  // è‡ªå‹•ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼
  addFallbackUrl(url: string): void;
  switchToFallback(): Promise<void>;
}

interface RPCHealthStatus {
  endpoint: string;
  status: 'healthy' | 'degraded' | 'unhealthy';
  latency: number;
  blockHeight: number;
  lastCheck: Date;
}
```

#### 4.2.2 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†
```typescript
interface TransactionManager {
  // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ä½œæˆ
  createTransferTransaction(
    from: PublicKey,
    to: PublicKey,
    amount: number,
    tokenMint: PublicKey
  ): Promise<Transaction>;

  // ãƒãƒƒãƒãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³
  createBatchTransactions(
    transfers: TokenTransfer[],
    batchSize: number
  ): Promise<Transaction[]>;

  // ç½²åãƒ»é€ä¿¡
  signTransaction(transaction: Transaction, keypair: Keypair): Promise<Transaction>;
  sendTransaction(transaction: Transaction): Promise<string>;
  confirmTransaction(signature: string): Promise<TransactionConfirmation>;

  // æ‰‹æ•°æ–™ç®¡ç†
  estimateTransactionFee(transaction: Transaction): Promise<number>;
  optimizeTransaction(transaction: Transaction): Promise<Transaction>;
}
```

### 4.3 å¤–éƒ¨API ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

#### 4.3.1 ä¾¡æ ¼æƒ…å ±API
```typescript
interface PriceOracle {
  // ä¾¡æ ¼å–å¾—
  getTokenPrice(tokenAddress: string): Promise<TokenPrice>;
  getMultipleTokenPrices(tokenAddresses: string[]): Promise<TokenPrice[]>;

  // å±¥æ­´ä¾¡æ ¼
  getHistoricalPrice(tokenAddress: string, date: Date): Promise<TokenPrice>;
  getPriceChart(tokenAddress: string, period: string): Promise<PricePoint[]>;
}

interface TokenPrice {
  tokenAddress: string;
  priceUSD: number;
  priceChange24h: number;
  marketCap: number;
  volume24h: number;
  lastUpdated: Date;
}
```

#### 4.3.2 é€šçŸ¥API
```typescript
interface NotificationService {
  // Webhooké€šçŸ¥
  sendWebhook(url: string, payload: any): Promise<void>;

  // å„ç¨®é€šçŸ¥
  sendSlackNotification(webhook: string, message: SlackMessage): Promise<void>;
  sendDiscordNotification(webhook: string, message: DiscordMessage): Promise<void>;
  sendEmailNotification(config: EmailConfig, message: EmailMessage): Promise<void>;
}

interface SlackMessage {
  text: string;
  channel?: string;
  username?: string;
  icon_emoji?: string;
  attachments?: SlackAttachment[];
}
```

### 4.4 å†…éƒ¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

#### 4.4.1 ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
```typescript
interface EventEmitter {
  // ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²
  on(event: string, listener: Function): void;
  once(event: string, listener: Function): void;
  off(event: string, listener: Function): void;

  // ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«
  emit(event: string, ...args: any[]): boolean;
  emitAsync(event: string, ...args: any[]): Promise<any[]>;
}

// ã‚·ã‚¹ãƒ†ãƒ ã‚¤ãƒ™ãƒ³ãƒˆ
type SystemEvent =
  | 'distribution.started'
  | 'distribution.completed'
  | 'distribution.failed'
  | 'transaction.confirmed'
  | 'transaction.failed'
  | 'wallet.collected'
  | 'config.updated'
  | 'error.occurred';
```

#### 4.4.2 ä¾å­˜æ€§æ³¨å…¥ã‚³ãƒ³ãƒ†ãƒŠ
```typescript
interface ServiceContainer {
  // ã‚µãƒ¼ãƒ“ã‚¹ç™»éŒ²
  register<T>(name: string, factory: () => T): void;
  registerSingleton<T>(name: string, factory: () => T): void;
  registerInstance<T>(name: string, instance: T): void;

  // ã‚µãƒ¼ãƒ“ã‚¹å–å¾—
  resolve<T>(name: string): T;
  resolveAll<T>(pattern: string): T[];

  // ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†
  dispose(): Promise<void>;
}
```

## 5. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ

### 5.1 ç§˜å¯†éµç®¡ç†

#### 5.1.1 æš—å·åŒ–ä»•æ§˜
```typescript
interface KeyEncryption {
  algorithm: 'AES-256-GCM';
  keyDerivation: {
    algorithm: 'PBKDF2';
    iterations: 100000;
    saltLength: 16;
    hashAlgorithm: 'SHA-256';
  };
  encryptionKey: {
    source: 'environment' | 'system' | 'user';
    length: 32; // bytes
  };
}
```

#### 5.1.2 ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 
```typescript
interface EncryptedWalletFile {
  version: string;              // æš—å·åŒ–ãƒãƒ¼ã‚¸ãƒ§ãƒ³
  algorithm: string;            // æš—å·åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
  salt: string;                 // ã‚½ãƒ«ãƒˆ (Base64)
  iv: string;                   // åˆæœŸåŒ–ãƒ™ã‚¯ã‚¿ãƒ¼ (Base64)
  authTag: string;              // èªè¨¼ã‚¿ã‚° (Base64)
  encryptedData: string;        // æš—å·åŒ–ã•ã‚ŒãŸç§˜å¯†éµ (Base64)
  createdAt: string;            // ä½œæˆæ—¥æ™‚ (ISO8601)
  metadata: {
    publicKey: string;          // å…¬é–‹éµ (Base58)
    keyLength: number;          // éµé•·
    checksum: string;           // ãƒã‚§ãƒƒã‚¯ã‚µãƒ 
  };
}
```

#### 5.1.3 ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
```typescript
interface AccessControl {
  // ãƒ•ã‚¡ã‚¤ãƒ«æ¨©é™
  filePermissions: {
    owner: 'read' | 'write';
    group: 'none';
    others: 'none';
  };

  // ãƒ¡ãƒ¢ãƒªä¿è­·
  memoryProtection: {
    clearOnExit: boolean;
    noSwap: boolean;
    lockMemory: boolean;
  };

  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
  sessionTimeout: number;       // ã‚»ãƒƒã‚·ãƒ§ãƒ³æœ‰åŠ¹æœŸé™ (ç§’)
  maxIdleTime: number;          // æœ€å¤§ã‚¢ã‚¤ãƒ‰ãƒ«æ™‚é–“ (ç§’)
  requireReauth: boolean;       // å†èªè¨¼è¦æ±‚
}
```

### 5.2 å…¥åŠ›æ¤œè¨¼

#### 5.2.1 ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è¦å‰‡
```typescript
interface ValidationRules {
  // Solanaã‚¢ãƒ‰ãƒ¬ã‚¹
  solanaAddress: {
    pattern: /^[1-9A-HJ-NP-Za-km-z]{32,44}$/;
    length: { min: 32, max: 44 };
    encoding: 'base58';
  };

  // ãƒˆãƒ¼ã‚¯ãƒ³é‡
  tokenAmount: {
    type: 'number';
    min: 0;
    max: Number.MAX_SAFE_INTEGER;
    decimals: { max: 9 };
  };

  // ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
  filePath: {
    maxLength: 4096;
    allowedExtensions: ['.json', '.csv', '.txt'];
    preventTraversal: true;
  };

  // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
  projectName: {
    pattern: /^[a-zA-Z0-9_-]+$/;
    length: { min: 1, max: 50 };
  };
}
```

#### 5.2.2 ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³
```typescript
interface InputSanitizer {
  // æ–‡å­—åˆ—ã‚µãƒ‹ã‚¿ã‚¤ã‚º
  sanitizeString(input: string): string;
  escapeHtml(input: string): string;
  removeControlChars(input: string): string;

  // ãƒ‘ã‚¹ã‚µãƒ‹ã‚¿ã‚¤ã‚º
  sanitizePath(path: string): string;
  resolveSecurePath(basePath: string, userPath: string): string;

  // æ•°å€¤ã‚µãƒ‹ã‚¿ã‚¤ã‚º
  sanitizeNumber(input: any): number | null;
  clampNumber(value: number, min: number, max: number): number;
}
```

### 5.3 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

#### 5.3.1 ã‚¨ãƒ©ãƒ¼åˆ†é¡
```typescript
enum ErrorCategory {
  VALIDATION = 'validation',
  NETWORK = 'network',
  BLOCKCHAIN = 'blockchain',
  FILESYSTEM = 'filesystem',
  CONFIGURATION = 'configuration',
  AUTHENTICATION = 'authentication',
  BUSINESS_LOGIC = 'business_logic',
  SYSTEM = 'system'
}

interface TributaryError extends Error {
  category: ErrorCategory;
  code: string;
  severity: 'low' | 'medium' | 'high' | 'critical';
  userMessage: string;
  technicalMessage: string;
  context: Record<string, any>;
  timestamp: Date;
  correlationId: string;
}
```

#### 5.3.2 ã‚¨ãƒ©ãƒ¼æƒ…å ±ã®ä¿è­·
```typescript
interface ErrorSanitizer {
  // æœ¬ç•ªç’°å¢ƒç”¨ã‚¨ãƒ©ãƒ¼
  sanitizeForProduction(error: TributaryError): PublicError;

  // ãƒ­ã‚°ç”¨ã‚¨ãƒ©ãƒ¼
  sanitizeForLogs(error: TributaryError): LogError;

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡¨ç¤ºç”¨ã‚¨ãƒ©ãƒ¼
  formatForUser(error: TributaryError): string;
}

interface PublicError {
  message: string;              // ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  code: string;                 // ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰
  correlationId: string;        // ç›¸é–¢ID (ã‚µãƒãƒ¼ãƒˆç”¨)
  // æ©Ÿå¯†æƒ…å ±ã¯å«ã¾ãªã„
}
```

### 5.4 ãƒ­ã‚°ãƒ»ç›£æŸ»

#### 5.4.1 ç›£æŸ»ãƒ­ã‚°è¦ä»¶
```typescript
interface AuditLog {
  timestamp: Date;              // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
  userId?: string;              // ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
  sessionId?: string;           // ã‚»ãƒƒã‚·ãƒ§ãƒ³ID
  action: AuditAction;          // å®Ÿè¡Œã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  resource: string;             // å¯¾è±¡ãƒªã‚½ãƒ¼ã‚¹
  result: 'success' | 'failure' | 'partial';
  details: AuditDetails;        // è©³ç´°æƒ…å ±
  ipAddress?: string;           // IPã‚¢ãƒ‰ãƒ¬ã‚¹
  userAgent?: string;           // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
  correlationId: string;        // ç›¸é–¢ID
}

type AuditAction =
  | 'wallet.collect'
  | 'distribution.execute'
  | 'config.update'
  | 'wallet.access'
  | 'report.generate'
  | 'auth.login'
  | 'auth.logout';

interface AuditDetails {
  parameters: Record<string, any>; // å®Ÿè¡Œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ (æ©Ÿå¯†æƒ…å ±é™¤ã)
  affected: {
    count: number;                 // å½±éŸ¿ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°
    resources: string[];           // å½±éŸ¿ãƒªã‚½ãƒ¼ã‚¹
  };
  timing: {
    startTime: Date;               // é–‹å§‹æ™‚é–“
    endTime: Date;                 // çµ‚äº†æ™‚é–“
    duration: number;              // å®Ÿè¡Œæ™‚é–“ (ms)
  };
}
```

#### 5.4.2 ãƒ­ã‚°ä¿è­·
```typescript
interface LogProtection {
  // æ©Ÿå¯†æƒ…å ±ã®ãƒã‚¹ã‚­ãƒ³ã‚°
  sensitiveFields: string[];    // ãƒã‚¹ã‚¯å¯¾è±¡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  maskingPattern: string;       // ãƒã‚¹ã‚¯ãƒ‘ã‚¿ãƒ¼ãƒ³ (ä¾‹: '***')

  // ãƒ­ã‚°ã®æ”¹ã–ã‚“é˜²æ­¢
  integrity: {
    enabled: boolean;
    algorithm: 'SHA-256';
    signWithKey: boolean;
  };

  // ãƒ­ã‚°ã®æš—å·åŒ–
  encryption: {
    enabled: boolean;
    algorithm: 'AES-256-CBC';
    rotateKeys: boolean;
  };
}
```

## 6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­è¨ˆ

### 6.1 å‡¦ç†æ€§èƒ½è¦ä»¶

#### 6.1.1 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™
```typescript
interface PerformanceTargets {
  // CLIå¿œç­”æ™‚é–“
  commandResponse: {
    simple: 100;        // ms (config showç­‰)
    moderate: 2000;     // ms (collectç­‰)
    complex: 30000;     // ms (distributeç­‰)
  };

  // ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ
  throughput: {
    walletCollection: 1000;      // addresses/minute
    tokenTransfers: 100;         // transactions/minute
    reportGeneration: 10;        // reports/minute
  };

  // ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡
  memory: {
    base: 50;           // MB (åŸºæœ¬ä½¿ç”¨é‡)
    peak: 200;          // MB (æœ€å¤§ä½¿ç”¨é‡)
    cache: 50;          // MB (ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨é‡)
  };

  // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
  network: {
    rpcLatency: 500;    // ms (å¹³å‡RPCå¿œç­”æ™‚é–“)
    bandwidth: 10;      // MB/min (å¹³å‡å¸¯åŸŸä½¿ç”¨é‡)
    concurrency: 10;    // åŒæ™‚æ¥ç¶šæ•°
  };
}
```

#### 6.1.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–
```typescript
interface PerformanceMonitor {
  // ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†
  startTiming(operation: string): TimingHandle;
  recordDuration(operation: string, duration: number): void;
  incrementCounter(metric: string, value?: number): void;
  recordGauge(metric: string, value: number): void;

  // ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ç›£è¦–
  getMemoryUsage(): MemoryUsage;
  getCPUUsage(): CPUUsage;
  getNetworkStats(): NetworkStats;

  // ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
  generatePerformanceReport(): PerformanceReport;
}

interface PerformanceReport {
  period: { start: Date; end: Date };
  metrics: {
    operations: OperationMetrics[];
    resources: ResourceMetrics;
    errors: ErrorMetrics;
  };
  recommendations: string[];
}
```

### 6.2 ä¸¦è¡Œå‡¦ç†è¨­è¨ˆ

#### 6.2.1 ä¸¦è¡Œå‡¦ç†æˆ¦ç•¥
```typescript
interface ConcurrencyStrategy {
  // ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ¼ãƒ«
  workerPool: {
    minWorkers: number;          // æœ€å°ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°
    maxWorkers: number;          // æœ€å¤§ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°
    idleTimeout: number;         // ã‚¢ã‚¤ãƒ‰ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ (ms)
    queueSize: number;           // ã‚­ãƒ¥ãƒ¼ã‚µã‚¤ã‚º
  };

  // ãƒãƒƒãƒå‡¦ç†
  batchProcessing: {
    defaultBatchSize: number;    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒƒãƒã‚µã‚¤ã‚º
    maxBatchSize: number;        // æœ€å¤§ãƒãƒƒãƒã‚µã‚¤ã‚º
    adaptiveSizing: boolean;     // é©å¿œçš„ã‚µã‚¤ã‚ºèª¿æ•´
  };

  // ãƒ¬ãƒ¼ãƒˆåˆ¶é™
  rateLimiting: {
    rpcRequests: number;         // RPCè¦æ±‚æ•°/ç§’
    tokenTransfers: number;      // ãƒˆãƒ¼ã‚¯ãƒ³è»¢é€æ•°/åˆ†
    apiCalls: number;            // APIå‘¼ã³å‡ºã—æ•°/åˆ†
  };
}
```

#### 6.2.2 éåŒæœŸå‡¦ç†ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
interface AsyncPatterns {
  // Promiseç®¡ç†
  promisePool: {
    maxConcurrent: number;       // æœ€å¤§åŒæ™‚å®Ÿè¡Œæ•°
    retryPolicy: RetryPolicy;    // ãƒªãƒˆãƒ©ã‚¤ãƒãƒªã‚·ãƒ¼
    timeoutMs: number;           // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
  };

  // ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å‡¦ç†
  streaming: {
    chunkSize: number;           // ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º
    bufferSize: number;          // ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚º
    backpressure: boolean;       // ãƒãƒƒã‚¯ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼åˆ¶å¾¡
  };
}

interface RetryPolicy {
  maxAttempts: number;           // æœ€å¤§è©¦è¡Œå›æ•°
  baseDelay: number;             // åŸºæœ¬é…å»¶ (ms)
  maxDelay: number;              // æœ€å¤§é…å»¶ (ms)
  exponentialBackoff: boolean;   // æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•
  jitter: boolean;               // ã‚¸ãƒƒã‚¿ãƒ¼è¿½åŠ 
}
```

### 6.3 ãƒ¡ãƒ¢ãƒªç®¡ç†

#### 6.3.1 ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡æœ€é©åŒ–
```typescript
interface MemoryOptimization {
  // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ—ãƒ¼ãƒ«
  objectPooling: {
    enabled: boolean;
    poolSize: number;            // ãƒ—ãƒ¼ãƒ«ã‚µã‚¤ã‚º
    maxAge: number;              // æœ€å¤§ä¿æŒæ™‚é–“ (ms)
  };

  // ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
  gcOptimization: {
    forceGC: boolean;            // å¼·åˆ¶GCå®Ÿè¡Œ
    gcThreshold: number;         // GCå®Ÿè¡Œé–¾å€¤ (MB)
    lowMemoryMode: boolean;      // ä½ãƒ¡ãƒ¢ãƒªãƒ¢ãƒ¼ãƒ‰
  };

  // ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
  streaming: {
    largeDataSets: boolean;      // å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå¯¾å¿œ
    chunkProcessing: boolean;    // ãƒãƒ£ãƒ³ã‚¯å‡¦ç†
    memoryThreshold: number;     // ãƒ¡ãƒ¢ãƒªé–¾å€¤ (MB)
  };
}
```

#### 6.3.2 ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯å¯¾ç­–
```typescript
interface MemoryLeakPrevention {
  // è‡ªå‹•ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  autoCleanup: {
    intervalMs: number;          // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—é–“éš”
    maxAge: number;              // æœ€å¤§ä¿æŒæ™‚é–“
    weakReferences: boolean;     // å¼±å‚ç…§ä½¿ç”¨
  };

  // ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†
  resourceTracking: {
    trackAllocations: boolean;   // ãƒ¡ãƒ¢ãƒªå‰²ã‚Šå½“ã¦è¿½è·¡
    trackFileHandles: boolean;   // ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒ³ãƒ‰ãƒ«è¿½è·¡
    trackConnections: boolean;   // æ¥ç¶šè¿½è·¡
  };
}
```

### 6.4 ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æœ€é©åŒ–

#### 6.4.1 RPCæœ€é©åŒ–
```typescript
interface RPCOptimization {
  // æ¥ç¶šãƒ—ãƒ¼ãƒ«
  connectionPool: {
    maxConnections: number;      // æœ€å¤§æ¥ç¶šæ•°
    keepAlive: boolean;          // Keep-Aliveä½¿ç”¨
    timeout: number;             // æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ (ms)
  };

  // ãƒªã‚¯ã‚¨ã‚¹ãƒˆæœ€é©åŒ–
  requestOptimization: {
    batchRequests: boolean;      // ãƒãƒƒãƒãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    compression: boolean;        // åœ§ç¸®ä½¿ç”¨
    retryLogic: RetryPolicy;     // ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯
  };

  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥
  caching: {
    blockInfoCache: number;      // ãƒ–ãƒ­ãƒƒã‚¯æƒ…å ±ã‚­ãƒ£ãƒƒã‚·ãƒ¥ (ç§’)
    tokenInfoCache: number;      // ãƒˆãƒ¼ã‚¯ãƒ³æƒ…å ±ã‚­ãƒ£ãƒƒã‚·ãƒ¥ (ç§’)
    accountInfoCache: number;    // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚­ãƒ£ãƒƒã‚·ãƒ¥ (ç§’)
  };
}
```

#### 6.4.2 å¸¯åŸŸå¹…æœ€é©åŒ–
```typescript
interface BandwidthOptimization {
  // ãƒ‡ãƒ¼ã‚¿åœ§ç¸®
  compression: {
    algorithm: 'gzip' | 'brotli';
    level: number;               // åœ§ç¸®ãƒ¬ãƒ™ãƒ«
    threshold: number;           // åœ§ç¸®é–¾å€¤ (bytes)
  };

  // å·®åˆ†æ›´æ–°
  deltaUpdates: {
    enabled: boolean;
    maxDeltaSize: number;        // æœ€å¤§å·®åˆ†ã‚µã‚¤ã‚º
    fallbackToFull: boolean;     // ãƒ•ãƒ«æ›´æ–°ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
  };

  // å„ªå…ˆåº¦åˆ¶å¾¡
  prioritization: {
    criticalOperations: string[]; // é‡è¦æ“ä½œãƒªã‚¹ãƒˆ
    throttleNonCritical: boolean; // éé‡è¦æ“ä½œã®åˆ¶é™
  };
}
```

## 7. ã‚¨ãƒ©ãƒ¼å‡¦ç†è¨­è¨ˆ

### 7.1 ã‚¨ãƒ©ãƒ¼åˆ†é¡

#### 7.1.1 ã‚¨ãƒ©ãƒ¼ã‚«ãƒ†ã‚´ãƒª
```typescript
enum ErrorCategory {
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚¨ãƒ©ãƒ¼
  USER_INPUT = 'user_input',

  // ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼
  SYSTEM = 'system',
  NETWORK = 'network',
  BLOCKCHAIN = 'blockchain',

  // ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼
  BUSINESS = 'business',
  VALIDATION = 'validation',

  // å¤–éƒ¨ä¾å­˜ã‚¨ãƒ©ãƒ¼
  EXTERNAL_API = 'external_api',
  FILE_SYSTEM = 'file_system',

  // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¨ãƒ©ãƒ¼
  SECURITY = 'security',
  AUTHENTICATION = 'authentication',
  AUTHORIZATION = 'authorization'
}
```

#### 7.1.2 ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä½“ç³»
```typescript
interface ErrorCode {
  category: ErrorCategory;
  code: string;
  httpStatus?: number;
  userMessage: string;
  technicalMessage: string;
  resolution: string;
  documentation?: string;
}

// ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä¾‹
const ERROR_CODES: Record<string, ErrorCode> = {
  'USR_001': {
    category: ErrorCategory.USER_INPUT,
    code: 'INVALID_TOKEN_ADDRESS',
    userMessage: 'ç„¡åŠ¹ãªãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæŒ‡å®šã•ã‚Œã¾ã—ãŸ',
    technicalMessage: 'Token address validation failed: invalid format',
    resolution: 'æ­£ã—ã„Solanaãƒˆãƒ¼ã‚¯ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒ‡å®šã—ã¦ãã ã•ã„'
  },

  'NET_001': {
    category: ErrorCategory.NETWORK,
    code: 'RPC_CONNECTION_FAILED',
    userMessage: 'Solanaãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã§ãã¾ã›ã‚“',
    technicalMessage: 'Failed to establish connection to Solana RPC endpoint',
    resolution: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèªã—ã€RPC URLãŒæ­£ã—ã„ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„'
  },

  'BCH_001': {
    category: ErrorCategory.BLOCKCHAIN,
    code: 'INSUFFICIENT_BALANCE',
    userMessage: 'æ®‹é«˜ãŒä¸è¶³ã—ã¦ã„ã¾ã™',
    technicalMessage: 'Wallet balance insufficient for transaction',
    resolution: 'ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã«ååˆ†ãªæ®‹é«˜ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„'
  }
};
```

### 7.2 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æˆ¦ç•¥

#### 7.2.1 ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ•ãƒ­ãƒ¼
```typescript
interface ErrorHandler {
  // ã‚¨ãƒ©ãƒ¼æ•ç²
  catch(error: Error, context: ErrorContext): Promise<HandledError>;

  // ã‚¨ãƒ©ãƒ¼åˆ†é¡
  classify(error: Error): ErrorCategory;

  // ã‚¨ãƒ©ãƒ¼å¤‰æ›
  transform(error: Error): TributaryError;

  // ã‚¨ãƒ©ãƒ¼å ±å‘Š
  report(error: TributaryError): Promise<void>;

  // å¾©æ—§å‡¦ç†
  recover(error: TributaryError): Promise<RecoveryResult>;
}

interface ErrorContext {
  operation: string;            // å®Ÿè¡Œä¸­ã®æ“ä½œ
  component: string;            // ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
  user?: string;               // ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
  correlationId: string;       // ç›¸é–¢ID
  metadata: Record<string, any>; // è¿½åŠ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
}

interface RecoveryResult {
  recovered: boolean;           // å¾©æ—§æˆåŠŸ/å¤±æ•—
  action: RecoveryAction;       // å®Ÿè¡Œã•ã‚ŒãŸå¾©æ—§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  message: string;              // å¾©æ—§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
}

enum RecoveryAction {
  RETRY = 'retry',
  FALLBACK = 'fallback',
  IGNORE = 'ignore',
  FAIL_FAST = 'fail_fast',
  USER_ACTION_REQUIRED = 'user_action_required'
}
```

#### 7.2.2 ã‚¨ãƒ©ãƒ¼å¾©æ—§æˆ¦ç•¥
```typescript
interface RecoveryStrategy {
  // è‡ªå‹•å¾©æ—§
  autoRecovery: {
    maxAttempts: number;         // æœ€å¤§è©¦è¡Œå›æ•°
    backoffStrategy: 'linear' | 'exponential';
    retryableErrors: string[];   // ãƒªãƒˆãƒ©ã‚¤å¯èƒ½ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰
  };

  // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
  fallback: {
    alternativeEndpoints: string[];   // ä»£æ›¿ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
    degradedMode: boolean;            // æ©Ÿèƒ½ç¸®é€€ãƒ¢ãƒ¼ãƒ‰
    cacheAsBackup: boolean;           // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã—ã¦ä½¿ç”¨
  };

  // ãƒ¦ãƒ¼ã‚¶ãƒ¼é€šçŸ¥
  notification: {
    immediateErrors: string[];        // å³åº§ã«é€šçŸ¥ã™ã‚‹ã‚¨ãƒ©ãƒ¼
    batchErrors: string[];            // ãƒãƒƒãƒã§é€šçŸ¥ã™ã‚‹ã‚¨ãƒ©ãƒ¼
    silentErrors: string[];           // ã‚µã‚¤ãƒ¬ãƒ³ãƒˆã‚¨ãƒ©ãƒ¼
  };
}
```

### 7.3 ãƒªãƒˆãƒ©ã‚¤æ©Ÿæ§‹

#### 7.3.1 ãƒªãƒˆãƒ©ã‚¤ãƒãƒªã‚·ãƒ¼
```typescript
interface RetryPolicy {
  // åŸºæœ¬è¨­å®š
  maxAttempts: number;          // æœ€å¤§è©¦è¡Œå›æ•°
  baseDelay: number;            // åŸºæœ¬é…å»¶æ™‚é–“ (ms)
  maxDelay: number;             // æœ€å¤§é…å»¶æ™‚é–“ (ms)

  // ãƒãƒƒã‚¯ã‚ªãƒ•æˆ¦ç•¥
  backoffStrategy: BackoffStrategy;
  jitter: boolean;              // ãƒ©ãƒ³ãƒ€ãƒ ã‚¸ãƒƒã‚¿ãƒ¼è¿½åŠ 

  // æ¡ä»¶è¨­å®š
  retryableErrors: string[];    // ãƒªãƒˆãƒ©ã‚¤å¯¾è±¡ã‚¨ãƒ©ãƒ¼
  nonRetryableErrors: string[]; // ãƒªãƒˆãƒ©ã‚¤é™¤å¤–ã‚¨ãƒ©ãƒ¼

  // å›è·¯ãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼
  circuitBreaker: {
    enabled: boolean;
    failureThreshold: number;    // å¤±æ•—é–¾å€¤
    timeoutMs: number;           // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“
    resetTimeoutMs: number;      // ãƒªã‚»ãƒƒãƒˆæ™‚é–“
  };
}

enum BackoffStrategy {
  LINEAR = 'linear',
  EXPONENTIAL = 'exponential',
  FIBONACCI = 'fibonacci',
  CUSTOM = 'custom'
}
```

#### 7.3.2 æ“ä½œåˆ¥ãƒªãƒˆãƒ©ã‚¤è¨­å®š
```typescript
const RETRY_POLICIES: Record<string, RetryPolicy> = {
  // RPCå‘¼ã³å‡ºã—
  rpc_call: {
    maxAttempts: 5,
    baseDelay: 1000,
    maxDelay: 10000,
    backoffStrategy: BackoffStrategy.EXPONENTIAL,
    jitter: true,
    retryableErrors: ['NET_001', 'NET_002'],
    nonRetryableErrors: ['USR_001', 'SEC_001']
  },

  // ãƒˆãƒ¼ã‚¯ãƒ³è»¢é€
  token_transfer: {
    maxAttempts: 3,
    baseDelay: 2000,
    maxDelay: 30000,
    backoffStrategy: BackoffStrategy.LINEAR,
    jitter: false,
    retryableErrors: ['BCH_002', 'NET_001'],
    nonRetryableErrors: ['BCH_001', 'USR_001']
  },

  // ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ
  file_operation: {
    maxAttempts: 3,
    baseDelay: 500,
    maxDelay: 5000,
    backoffStrategy: BackoffStrategy.EXPONENTIAL,
    jitter: true,
    retryableErrors: ['SYS_001', 'SYS_002'],
    nonRetryableErrors: ['USR_002', 'SEC_002']
  }
};
```

### 7.4 ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

#### 7.4.1 ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¨­è¨ˆ
```typescript
interface UserErrorMessage {
  // åŸºæœ¬æƒ…å ±
  title: string;                // ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒˆãƒ«
  message: string;              // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  severity: ErrorSeverity;      // é‡è¦åº¦

  // è©³ç´°æƒ…å ±
  details?: string;             // è©³ç´°èª¬æ˜
  cause?: string;               // åŸå› 
  resolution: string;           // è§£æ±ºæ–¹æ³•

  // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  actions: ErrorAction[];       // å®Ÿè¡Œå¯èƒ½ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
  helpUrl?: string;             // ãƒ˜ãƒ«ãƒ—URL

  // æŠ€è¡“æƒ…å ±
  correlationId: string;        // ç›¸é–¢IDï¼ˆã‚µãƒãƒ¼ãƒˆç”¨ï¼‰
  timestamp: Date;              // ç™ºç”Ÿæ™‚åˆ»
}

enum ErrorSeverity {
  INFO = 'info',
  WARNING = 'warning',
  ERROR = 'error',
  CRITICAL = 'critical'
}

interface ErrorAction {
  label: string;                // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ©ãƒ™ãƒ«
  action: string;               // ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¨®åˆ¥
  command?: string;             // å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
  url?: string;                 // å‚ç…§URL
}
```

#### 7.4.2 ãƒ—ãƒ­ã‚°ãƒ¬ãƒƒã‚·ãƒ–ãƒ‡ã‚£ã‚¹ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ãƒ¼
```typescript
interface ErrorDisplay {
  // æ®µéšçš„æƒ…å ±é–‹ç¤º
  levels: {
    basic: string;              // åŸºæœ¬ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    detailed: string;           // è©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    technical: string;          // æŠ€è¡“è©³ç´°
    debug: string;              // ãƒ‡ãƒãƒƒã‚°æƒ…å ±
  };

  // è¡¨ç¤ºåˆ¶å¾¡
  defaultLevel: 'basic' | 'detailed';
  allowExpansion: boolean;      // è©³ç´°å±•é–‹è¨±å¯
  showTechnical: boolean;       // æŠ€è¡“æƒ…å ±è¡¨ç¤º

  // ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±
  showContext: boolean;         // ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤º
  showSuggestions: boolean;     // ææ¡ˆè¡¨ç¤º
  showRelatedErrors: boolean;   // é–¢é€£ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
}
```

## 8. ãƒ†ã‚¹ãƒˆè¨­è¨ˆ

### 8.1 ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

#### 8.1.1 ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰
```typescript
interface TestStrategy {
  // ãƒ†ã‚¹ãƒˆãƒ¬ãƒ™ãƒ«
  unitTests: {
    coverage: 90;               // ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ (%)
    framework: 'jest';          // ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
    mockStrategy: 'dependency_injection';
  };

  integrationTests: {
    coverage: 70;               // ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ (%)
    environment: 'devnet';      // ãƒ†ã‚¹ãƒˆç’°å¢ƒ
    dataIsolation: true;        // ãƒ‡ãƒ¼ã‚¿åˆ†é›¢
  };

  e2eTests: {
    coverage: 50;               // ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ (%)
    automation: true;           // è‡ªå‹•åŒ–
    environment: 'testnet';     // ãƒ†ã‚¹ãƒˆç’°å¢ƒ
  };

  performanceTests: {
    loadTesting: true;          // è² è·ãƒ†ã‚¹ãƒˆ
    stressTesting: true;        // ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ
    benchmark: true;            // ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯
  };
}
```

#### 8.1.2 ãƒ†ã‚¹ãƒˆç’°å¢ƒæ§‹æˆ
```typescript
interface TestEnvironment {
  // ç’°å¢ƒåˆ†é›¢
  isolation: {
    database: 'memory';         // ãƒ†ã‚¹ãƒˆç”¨DB
    filesystem: 'temporary';    // ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ 
    network: 'mock';            // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ¢ãƒƒã‚¯
  };

  // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
  testData: {
    fixtures: string[];         // ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£ãƒ•ã‚¡ã‚¤ãƒ«
    factories: string[];        // ãƒ•ã‚¡ã‚¯ãƒˆãƒªã‚¯ãƒ©ã‚¹
    seeds: string[];            // ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿
  };

  // ãƒ¢ãƒƒã‚¯è¨­å®š
  mocks: {
    solanaRPC: MockConfig;      // Solana RPCãƒ¢ãƒƒã‚¯
    externalAPIs: MockConfig;   // å¤–éƒ¨APIãƒ¢ãƒƒã‚¯
    filesystem: MockConfig;     // ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãƒ¢ãƒƒã‚¯
  };
}
```

### 8.2 å˜ä½“ãƒ†ã‚¹ãƒˆè¨­è¨ˆ

#### 8.2.1 ãƒ†ã‚¹ãƒˆæ§‹æˆ
```typescript
// ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 
interface UnitTestStructure {
  // ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ
  suites: {
    'WalletCollector.test.ts': TestSuite;
    'DistributionEngine.test.ts': TestSuite;
    'TokenService.test.ts': TestSuite;
    'CLIInterface.test.ts': TestSuite;
    'ConfigManager.test.ts': TestSuite;
    'ReportGenerator.test.ts': TestSuite;
  };

  // å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
  utilities: {
    'testUtils.ts': TestUtilities;
    'mockFactory.ts': MockFactory;
    'fixtures.ts': TestFixtures;
  };
}

interface TestSuite {
  describe: string;             // ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå
  beforeEach: SetupFunction;    // ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
  afterEach: TeardownFunction;  // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  testCases: TestCase[];        // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
}
```

#### 8.2.2 ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¾‹
```typescript
// WalletCollector ãƒ†ã‚¹ãƒˆä¾‹
describe('WalletCollector', () => {
  let walletCollector: WalletCollector;
  let mockTokenService: jest.Mocked<ITokenService>;
  let mockConfigManager: jest.Mocked<IConfigManager>;
  let mockLogger: jest.Mocked<ILogger>;

  beforeEach(() => {
    mockTokenService = createMockTokenService();
    mockConfigManager = createMockConfigManager();
    mockLogger = createMockLogger();

    walletCollector = new WalletCollector(
      mockTokenService,
      mockConfigManager,
      mockLogger
    );
  });

  describe('collectHolders', () => {
    it('should collect token holders successfully', async () => {
      // Arrange
      const params: CollectHoldersParams = {
        tokenAddress: 'TokenAddress123',
        minBalance: 100,
        useCache: false
      };

      const mockAccounts = createMockTokenAccounts(5);
      mockTokenService.getTokenAccounts.mockResolvedValue(mockAccounts);

      // Act
      const result = await walletCollector.collectHolders(params);

      // Assert
      expect(result).toHaveLength(5);
      expect(result[0].balance).toBeGreaterThanOrEqual(100);
      expect(mockTokenService.getTokenAccounts).toHaveBeenCalledWith(params.tokenAddress);
    });

    it('should filter holders by minimum balance', async () => {
      // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè£…
    });

    it('should use cached data when available', async () => {
      // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè£…
    });

    it('should handle empty holder list', async () => {
      // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè£…
    });

    it('should handle network errors gracefully', async () => {
      // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè£…
    });
  });
});
```

### 8.3 çµ±åˆãƒ†ã‚¹ãƒˆè¨­è¨ˆ

#### 8.3.1 çµ±åˆãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª
```typescript
interface IntegrationTestScenario {
  // ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ•ãƒ­ãƒ¼
  endToEndFlow: {
    'complete_distribution_flow': {
      steps: [
        'initialize_project',
        'collect_token_holders',
        'execute_distribution',
        'generate_report'
      ];
      assertions: string[];
      cleanup: string[];
    };
  };

  // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“é€£æº
  componentIntegration: {
    'wallet_collector_token_service': {
      scenario: string;
      components: ['WalletCollector', 'TokenService'];
      mockDependencies: string[];
    };
  };

  // å¤–éƒ¨ä¾å­˜ãƒ†ã‚¹ãƒˆ
  externalDependencies: {
    'solana_rpc_integration': {
      network: 'devnet';
      realConnections: boolean;
      fallbackMocks: boolean;
    };
  };
}
```

#### 8.3.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ
```typescript
// çµ±åˆãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
interface IntegrationTestDB {
  setup: {
    createTempDatabase: () => Promise<void>;
    seedTestData: () => Promise<void>;
    createIndexes: () => Promise<void>;
  };

  cleanup: {
    clearTestData: () => Promise<void>;
    dropTempDatabase: () => Promise<void>;
  };

  assertions: {
    verifyDataIntegrity: () => Promise<boolean>;
    checkConstraints: () => Promise<boolean>;
  };
}
```

### 8.4 E2Eãƒ†ã‚¹ãƒˆè¨­è¨ˆ

#### 8.4.1 E2Eãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª
```typescript
interface E2ETestScenario {
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼
  userJourneys: {
    'first_time_user_setup': {
      description: 'åˆå›ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ•ãƒ­ãƒ¼';
      steps: [
        'run_tributary_init',
        'configure_wallet',
        'verify_network_connection',
        'collect_sample_holders',
        'execute_test_distribution'
      ];
      expectedOutcomes: string[];
    };

    'experienced_user_workflow': {
      description: 'çµŒé¨“è€…ã®é€šå¸¸ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼';
      steps: [
        'load_existing_config',
        'collect_large_holder_set',
        'execute_batch_distribution',
        'generate_comprehensive_report'
      ];
      expectedOutcomes: string[];
    };
  };

  // ã‚¨ãƒ©ãƒ¼ã‚·ãƒŠãƒªã‚ª
  errorScenarios: {
    'network_failure_recovery': {
      description: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³ã‹ã‚‰ã®å¾©æ—§';
      failurePoint: string;
      recoveryMechanism: string;
      expectedBehavior: string;
    };
  };
}
```

#### 8.4.2 E2Eãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–
```typescript
interface E2EAutomation {
  // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œç’°å¢ƒ
  environment: {
    containerized: boolean;      // ã‚³ãƒ³ãƒ†ãƒŠåŒ–
    parallelExecution: boolean;  // ä¸¦åˆ—å®Ÿè¡Œ
    cloudExecution: boolean;     // ã‚¯ãƒ©ã‚¦ãƒ‰å®Ÿè¡Œ
  };

  // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç®¡ç†
  testDataManagement: {
    dataGeneration: 'factory' | 'fixtures' | 'dynamic';
    dataCleanup: 'automatic' | 'manual';
    dataIsolation: boolean;
  };

  // ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
  reporting: {
    format: 'html' | 'json' | 'junit';
    screenshots: boolean;        // ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
    videoRecording: boolean;     // ãƒ“ãƒ‡ã‚ªéŒ²ç”»
    performanceMetrics: boolean; // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™
  };
}
```

## 9. é‹ç”¨è¨­è¨ˆ

### 9.1 ãƒ­ã‚°è¨­è¨ˆ

#### 9.1.1 ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«å®šç¾©
```typescript
enum LogLevel {
  DEBUG = 0,    // è©³ç´°ãªãƒ‡ãƒãƒƒã‚°æƒ…å ±
  INFO = 1,     // ä¸€èˆ¬çš„ãªæƒ…å ±
  WARN = 2,     // è­¦å‘Šï¼ˆå‡¦ç†ã¯ç¶™ç¶šï¼‰
  ERROR = 3,    // ã‚¨ãƒ©ãƒ¼ï¼ˆå‡¦ç†ã¯ç¶™ç¶šï¼‰
  FATAL = 4     // è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ï¼ˆå‡¦ç†åœæ­¢ï¼‰
}

interface LogConfig {
  // åŸºæœ¬è¨­å®š
  level: LogLevel;              // å‡ºåŠ›ãƒ¬ãƒ™ãƒ«
  format: 'json' | 'text';      // å‡ºåŠ›å½¢å¼
  timestamp: boolean;           // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—

  // å‡ºåŠ›å…ˆè¨­å®š
  outputs: LogOutput[];         // å‡ºåŠ›å…ˆãƒªã‚¹ãƒˆ

  // ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
  rotation: {
    enabled: boolean;
    maxSize: string;            // '10MB'
    maxFiles: number;           // 30
    compress: boolean;          // true
  };

  // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
  filters: {
    excludePatterns: string[];  // é™¤å¤–ãƒ‘ã‚¿ãƒ¼ãƒ³
    includeOnlyPatterns: string[]; // åŒ…å«ãƒ‘ã‚¿ãƒ¼ãƒ³
    sensitiveFields: string[];  // æ©Ÿå¯†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  };
}
```

#### 9.1.2 æ§‹é€ åŒ–ãƒ­ã‚°å½¢å¼
```typescript
interface StructuredLog {
  // åŸºæœ¬ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  timestamp: string;            // ISO8601å½¢å¼
  level: string;                // ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«
  message: string;              // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

  // ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±
  component: string;            // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå
  operation: string;            // æ“ä½œå
  correlationId: string;        // ç›¸é–¢ID

  // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
  metadata: {
    userId?: string;            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
    sessionId?: string;         // ã‚»ãƒƒã‚·ãƒ§ãƒ³ID
    requestId?: string;         // ãƒªã‚¯ã‚¨ã‚¹ãƒˆID
    version: string;            // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³
    environment: string;        // å®Ÿè¡Œç’°å¢ƒ
  };

  // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æƒ…å ±
  performance?: {
    duration: number;           // å®Ÿè¡Œæ™‚é–“ (ms)
    memoryUsage: number;        // ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ (bytes)
    cpuUsage: number;           // CPUä½¿ç”¨ç‡ (%)
  };

  // ã‚¨ãƒ©ãƒ¼æƒ…å ±
  error?: {
    name: string;               // ã‚¨ãƒ©ãƒ¼å
    message: string;            // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    stack: string;              // ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹
    code: string;               // ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰
  };
}
```

### 9.2 ç›£è¦–è¨­è¨ˆ

#### 9.2.1 ç›£è¦–ãƒ¡ãƒˆãƒªã‚¯ã‚¹
```typescript
interface MonitoringMetrics {
  // ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹
  system: {
    cpuUsage: GaugeMetric;      // CPUä½¿ç”¨ç‡
    memoryUsage: GaugeMetric;   // ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
    diskUsage: GaugeMetric;     // ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡
    networkIO: CounterMetric;   // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯I/O
  };

  // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒˆãƒªã‚¯ã‚¹
  application: {
    commandExecutions: CounterMetric;     // ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ•°
    distributionCount: CounterMetric;     // é…å¸ƒå®Ÿè¡Œæ•°
    tokenTransfers: CounterMetric;        // ãƒˆãƒ¼ã‚¯ãƒ³è»¢é€æ•°
    errorCount: CounterMetric;            // ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ•°
    responseTime: HistogramMetric;        // å¿œç­”æ™‚é–“
  };

  // ãƒ“ã‚¸ãƒã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹
  business: {
    totalAmountDistributed: CounterMetric; // ç·é…å¸ƒé‡
    uniqueRecipients: GaugeMetric;        // ãƒ¦ãƒ‹ãƒ¼ã‚¯å—ä¿¡è€…æ•°
    successRate: GaugeMetric;             // æˆåŠŸç‡
    averageTransactionCost: GaugeMetric;  // å¹³å‡æ‰‹æ•°æ–™
  };
}

interface MetricDefinition {
  name: string;                 // ãƒ¡ãƒˆãƒªã‚¯ã‚¹å
  type: 'counter' | 'gauge' | 'histogram';
  description: string;          // èª¬æ˜
  labels: string[];             // ãƒ©ãƒ™ãƒ«
  unit?: string;                // å˜ä½
}
```

#### 9.2.2 ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
```typescript
interface HealthCheck {
  // åŸºæœ¬ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
  basic: {
    status: 'healthy' | 'degraded' | 'unhealthy';
    timestamp: Date;
    version: string;
    uptime: number;             // ç¨¼åƒæ™‚é–“ (ç§’)
  };

  // è©³ç´°ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
  detailed: {
    dependencies: DependencyHealth[];
    resources: ResourceHealth[];
    services: ServiceHealth[];
  };

  // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™
  performance: {
    responseTime: number;       // å¿œç­”æ™‚é–“ (ms)
    throughput: number;         // ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ
    errorRate: number;          // ã‚¨ãƒ©ãƒ¼ç‡ (%)
    resourceUtilization: number; // ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨ç‡ (%)
  };
}

interface DependencyHealth {
  name: string;                 // ä¾å­˜é–¢ä¿‚å
  status: HealthStatus;         // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
  latency: number;              // ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· (ms)
  lastCheck: Date;              // æœ€çµ‚ãƒã‚§ãƒƒã‚¯æ™‚åˆ»
  errorMessage?: string;        // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
}
```

### 9.3 ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¨­è¨ˆ

#### 9.3.1 å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
```typescript
interface MaintenanceSchedule {
  // æ—¥æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
  daily: {
    logRotation: {
      time: '02:00';            // å®Ÿè¡Œæ™‚åˆ»
      retention: 30;            // ä¿æŒæ—¥æ•°
    };

    cacheCleanup: {
      time: '03:00';
      maxAge: 24;               // æœ€å¤§ä¿æŒæ™‚é–“ (æ™‚é–“)
    };

    backupVerification: {
      time: '04:00';
      testRestore: boolean;     // å¾©å…ƒãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
    };
  };

  // é€±æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
  weekly: {
    performanceReport: {
      day: 'sunday';
      time: '01:00';
      recipients: string[];     // é€ä¿¡å…ˆãƒªã‚¹ãƒˆ
    };

    securityScan: {
      day: 'saturday';
      time: '02:00';
      scanTypes: string[];      // ã‚¹ã‚­ãƒ£ãƒ³ç¨®åˆ¥
    };
  };

  // æœˆæ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
  monthly: {
    systemUpdate: {
      day: 1;                   // æœˆã®æ—¥
      time: '01:00';
      autoApprove: boolean;     // è‡ªå‹•æ‰¿èª
    };

    archiving: {
      day: 28;
      oldDataThreshold: 90;     // æ—¥æ•°é–¾å€¤
    };
  };
}
```

#### 9.3.2 ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥
```typescript
interface BackupStrategy {
  // è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
  configuration: {
    frequency: 'daily';
    retention: 30;              // ä¿æŒæ—¥æ•°
    location: 'local' | 'cloud';
    encryption: boolean;
  };

  // ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
  logs: {
    frequency: 'weekly';
    retention: 90;              // ä¿æŒæ—¥æ•°
    compression: boolean;
    archiveLocation: string;
  };

  // ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
  data: {
    frequency: 'daily';
    retention: 365;             // ä¿æŒæ—¥æ•°
    incrementalBackup: boolean;
    verifyIntegrity: boolean;
  };

  // å¾©å…ƒæ‰‹é †
  restoration: {
    automatedRestore: boolean;
    testSchedule: 'monthly';
    documentationUrl: string;
  };
}
```

### 9.4 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè¨­è¨ˆ

#### 9.4.1 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæˆ¦ç•¥
```typescript
interface DeploymentStrategy {
  // ç’°å¢ƒç®¡ç†
  environments: {
    development: EnvironmentConfig;
    testing: EnvironmentConfig;
    staging: EnvironmentConfig;
    production: EnvironmentConfig;
  };

  // ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
  pipeline: {
    stages: DeploymentStage[];
    approvals: ApprovalConfig[];
    rollback: RollbackConfig;
  };

  // é…å¸ƒæ–¹æ³•
  distribution: {
    npm: NPMDistribution;
    binary: BinaryDistribution;
    docker: DockerDistribution;
    source: SourceDistribution;
  };
}

interface EnvironmentConfig {
  name: string;
  solanaNetwork: SolanaNetwork;
  rpcEndpoints: string[];
  logLevel: LogLevel;
  monitoring: boolean;
  autoScaling: boolean;
}

interface DeploymentStage {
  name: string;
  environment: string;
  prerequisites: string[];
  actions: DeploymentAction[];
  healthChecks: HealthCheck[];
  rollbackTriggers: string[];
}
```

#### 9.4.2 ç¶™ç¶šçš„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
```typescript
interface CIConfig {
  // ãƒ“ãƒ«ãƒ‰ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
  build: {
    triggers: ['push', 'pull_request'];
    stages: [
      'lint',
      'test',
      'security_scan',
      'build',
      'package'
    ];
    artifacts: string[];
    cache: CacheConfig;
  };

  // ãƒ†ã‚¹ãƒˆè¨­å®š
  testing: {
    unitTests: {
      coverage: 90;
      parallelization: true;
    };

    integrationTests: {
      environment: 'docker';
      testData: 'generated';
    };

    e2eTests: {
      environment: 'staging';
      browsers: string[];
    };
  };

  // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
  security: {
    dependencyScanning: boolean;
    secretsScanning: boolean;
    licenseCompliance: boolean;
    vulnerabilityAssessment: boolean;
  };
}
```

## 10. å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### 10.1 ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

#### 10.1.1 TypeScriptè¦ç´„
```typescript
// ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆè¦ç´„
interface FileStructure {
  // ãƒ•ã‚¡ã‚¤ãƒ«å‘½å
  naming: {
    components: 'PascalCase';     // TokenService.ts
    utilities: 'camelCase';       // tokenUtils.ts
    constants: 'UPPER_SNAKE';     // CONFIG_CONSTANTS.ts
    types: 'PascalCase';          // UserTypes.ts
  };

  // ã‚¤ãƒ³ãƒãƒ¼ãƒˆé †åº
  importOrder: [
    'node_modules',               // å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
    'src/types',                  // å‹å®šç¾©
    'src/utils',                  // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
    'src/services',               // ã‚µãƒ¼ãƒ“ã‚¹
    'relative'                    // ç›¸å¯¾ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
  ];

  // ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¦ç´„
  exports: {
    default: 'class' | 'function'; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
    named: 'interface' | 'type' | 'constant'; // åå‰ä»˜ãã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
  };
}

// ã‚³ãƒ¼ãƒ‰å“è³ªè¦ç´„
interface CodeQuality {
  // é–¢æ•°è¨­è¨ˆ
  functions: {
    maxLength: 50;                // æœ€å¤§è¡Œæ•°
    maxParameters: 5;             // æœ€å¤§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°
    pureFunction: boolean;        // ç´”ç²‹é–¢æ•°æ¨å¥¨
    singleResponsibility: boolean; // å˜ä¸€è²¬ä»»åŸå‰‡
  };

  // ã‚¯ãƒ©ã‚¹è¨­è¨ˆ
  classes: {
    maxLength: 200;               // æœ€å¤§è¡Œæ•°
    maxMethods: 20;               // æœ€å¤§ãƒ¡ã‚½ãƒƒãƒ‰æ•°
    composition: boolean;         // ç¶™æ‰¿ã‚ˆã‚Šå§”è­²
    immutable: boolean;           // ä¸å¤‰æ€§é‡è¦–
  };

  // ã‚³ãƒ¡ãƒ³ãƒˆè¦ç´„
  comments: {
    jsdoc: boolean;               // JSDocå¿…é ˆ
    complexity: boolean;          // è¤‡é›‘ãªå‡¦ç†ã«ã¯ã‚³ãƒ¡ãƒ³ãƒˆ
    publicAPI: boolean;           // ãƒ‘ãƒ–ãƒªãƒƒã‚¯APIã¯è©³ç´°ã‚³ãƒ¡ãƒ³ãƒˆ
  };
}
```

#### 10.1.2 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¦ç´„
```typescript
// ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³
interface ErrorHandlingConventions {
  // ä¾‹å¤–è¨­è¨ˆ
  exceptions: {
    customErrors: boolean;        // ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ä½¿ç”¨
    errorChaining: boolean;       // ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒ¼ãƒ³
    contextualInfo: boolean;      // ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±ä»˜ä¸
  };

  // éåŒæœŸã‚¨ãƒ©ãƒ¼
  asyncErrors: {
    promiseRejection: 'explicit'; // æ˜ç¤ºçš„ãªPromise rejection
    trycatchUsage: 'required';   // try-catchå¿…é ˆ
    errorPropagation: 'controlled'; // åˆ¶å¾¡ã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ä¼æ’­
  };

  // ãƒ­ã‚°å‡ºåŠ›
  errorLogging: {
    structured: boolean;          // æ§‹é€ åŒ–ãƒ­ã‚°
    correlation: boolean;         // ç›¸é–¢ID
    sensitiveData: 'masked';      // æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ãƒã‚¹ã‚¯
  };
}
```

### 10.2 ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

#### 10.2.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 
```
tributary/
â”œâ”€â”€ src/                        # ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ types/                  # å‹å®šç¾©
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”œâ”€â”€ config.ts
â”‚   â”‚   â””â”€â”€ errors.ts
â”‚   â”œâ”€â”€ utils/                  # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â”œâ”€â”€ crypto.ts
â”‚   â”‚   â”œâ”€â”€ validation.ts
â”‚   â”‚   â”œâ”€â”€ formatting.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ services/               # ã‚µãƒ¼ãƒ“ã‚¹å±¤
â”‚   â”‚   â”œâ”€â”€ TokenService.ts
â”‚   â”‚   â”œâ”€â”€ ConfigManager.ts
â”‚   â”‚   â”œâ”€â”€ LoggerService.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ components/             # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤
â”‚   â”‚   â”œâ”€â”€ WalletCollector.ts
â”‚   â”‚   â”œâ”€â”€ DistributionEngine.ts
â”‚   â”‚   â”œâ”€â”€ ReportGenerator.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ interfaces/             # ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ cli/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ cli/                    # CLIå®Ÿè£…
â”‚   â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â”œâ”€â”€ CLIInterface.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ config/                 # è¨­å®š
â”‚   â”‚   â”œâ”€â”€ default.ts
â”‚   â”‚   â”œâ”€â”€ development.ts
â”‚   â”‚   â”œâ”€â”€ production.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ index.ts                # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ tests/                      # ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ integration/
â”‚   â”œâ”€â”€ e2e/
â”‚   â”œâ”€â”€ fixtures/
â”‚   â””â”€â”€ utils/
â”œâ”€â”€ docs/                       # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ guides/
â”‚   â””â”€â”€ examples/
â”œâ”€â”€ scripts/                    # ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ configs/                    # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ jest.config.js
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ eslint.config.js
â”‚   â””â”€â”€ prettier.config.js
â”œâ”€â”€ dist/                       # ãƒ“ãƒ«ãƒ‰æˆæœç‰©
â”œâ”€â”€ coverage/                   # ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸
â”œâ”€â”€ node_modules/               # ä¾å­˜é–¢ä¿‚
â”œâ”€â”€ package.json
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ README.md
â”œâ”€â”€ CHANGELOG.md
â”œâ”€â”€ LICENSE
â””â”€â”€ .gitignore
```

#### 10.2.2 ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ†å‰²è¦å‰‡
```typescript
interface ModularDesign {
  // ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ†å‰²
  layers: {
    presentation: 'cli/';        // UIå±¤
    application: 'components/';  // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤
    domain: 'services/';         // ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤
    infrastructure: 'utils/';    // ã‚¤ãƒ³ãƒ•ãƒ©å±¤
  };

  // ä¾å­˜é–¢ä¿‚ãƒ«ãƒ¼ãƒ«
  dependencies: {
    direction: 'downward';       // ä¸‹å‘ãä¾å­˜ã®ã¿
    interfaces: 'abstraction';   // æŠ½è±¡ã«ä¾å­˜
    circular: 'prohibited';      // å¾ªç’°ä¾å­˜ç¦æ­¢
  };

  // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆ
  modules: {
    cohesion: 'high';           // é«˜å‡é›†
    coupling: 'low';            // ç–çµåˆ
    singlePurpose: boolean;     // å˜ä¸€ç›®çš„
  };
}
```

### 10.3 ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¾å­˜é–¢ä¿‚

#### 10.3.1 ä¾å­˜é–¢ä¿‚ç®¡ç†
```json
{
  "dependencies": {
    "@solana/web3.js": "^1.87.6",
    "@solana/spl-token": "^0.3.8",
    "@metaplex-foundation/js": "^0.19.4",
    "commander": "^11.0.0",
    "inquirer": "^9.2.8",
    "chalk": "^5.3.0",
    "winston": "^3.10.0",
    "config": "^3.3.9",
    "dotenv": "^16.3.1",
    "axios": "^1.5.0",
    "csv-writer": "^1.6.0",
    "node-cache": "^5.1.2"
  },
  "devDependencies": {
    "@types/node": "^20.5.0",
    "@types/jest": "^29.5.4",
    "@types/inquirer": "^9.0.3",
    "typescript": "^5.1.6",
    "jest": "^29.6.2",
    "ts-jest": "^29.1.1",
    "eslint": "^8.47.0",
    "@typescript-eslint/parser": "^6.4.0",
    "@typescript-eslint/eslint-plugin": "^6.4.0",
    "prettier": "^3.0.2",
    "husky": "^8.0.3",
    "lint-staged": "^14.0.1",
    "ts-node": "^10.9.1",
    "nodemon": "^3.0.1"
  },
  "peerDependencies": {
    "node": ">=18.0.0"
  }
}
```

#### 10.3.2 ä¾å­˜é–¢ä¿‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
```typescript
interface DependencySecurity {
  // ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»
  audit: {
    automated: boolean;         // è‡ªå‹•ç›£æŸ»
    schedule: 'daily';          // ç›£æŸ»é »åº¦
    severity: 'high';           // å¯¾å¿œé‡è¦åº¦
  };

  // æ›´æ–°æˆ¦ç•¥
  updates: {
    patch: 'automatic';         // ãƒ‘ãƒƒãƒæ›´æ–°
    minor: 'reviewed';          // ãƒã‚¤ãƒŠãƒ¼æ›´æ–°
    major: 'manual';            // ãƒ¡ã‚¸ãƒ£ãƒ¼æ›´æ–°
  };

  // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç®¡ç†
  licensing: {
    allowedLicenses: [
      'MIT',
      'Apache-2.0',
      'BSD-3-Clause'
    ];
    prohibitedLicenses: [
      'GPL-3.0',
      'AGPL-3.0'
    ];
  };
}
```

### 10.4 ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°

#### 10.4.1 ãƒ“ãƒ«ãƒ‰è¨­å®š
```typescript
// TypeScriptè¨­å®š (tsconfig.json)
interface BuildConfig {
  typescript: {
    target: 'ES2022';
    module: 'CommonJS';
    strict: true;
    esModuleInterop: true;
    skipLibCheck: true;
    forceConsistentCasingInFileNames: true;

    paths: {
      '@/*': ['src/*'];
      '@types/*': ['src/types/*'];
      '@utils/*': ['src/utils/*'];
    };
  };

  // ãƒ“ãƒ«ãƒ‰æœ€é©åŒ–
  optimization: {
    minification: boolean;      // æœ€å°åŒ–
    treeShaking: boolean;       // Tree shaking
    bundling: 'webpack' | 'esbuild';
    sourceMaps: boolean;        // ã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—
  };

  // å‡ºåŠ›è¨­å®š
  output: {
    directory: 'dist/';
    formats: ['cjs', 'esm'];
    declaration: boolean;       // å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
  };
}
```

#### 10.4.2 ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ³ã‚°æˆ¦ç•¥
```typescript
interface PackagingStrategy {
  // NPM ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
  npm: {
    scope: '@tributary';
    registry: 'npmjs.org';
    access: 'public';
    files: [
      'dist/',
      'README.md',
      'LICENSE',
      'CHANGELOG.md'
    ];
  };

  // ãƒã‚¤ãƒŠãƒª ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
  binary: {
    tool: 'pkg';
    targets: [
      'node18-linux-x64',
      'node18-macos-x64',
      'node18-win-x64'
    ];
    compression: 'gzip';
  };

  // Docker ã‚¤ãƒ¡ãƒ¼ã‚¸
  docker: {
    baseImage: 'node:18-alpine';
    multiStage: boolean;
    security: 'distroless';
    registry: 'ghcr.io';
  };

  // ãƒªãƒªãƒ¼ã‚¹ç®¡ç†
  release: {
    versioning: 'semantic';     // ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°
    automation: 'github-actions';
    changelog: 'conventional-commits';
    assets: ['binary', 'npm', 'docker'];
  };
}
```